{"version":3,"file":"index.js","sources":["../src/assets/icon_trash.jsx","../src/components/EntityComponent/EntityValue.jsx","../src/components/EntityComponent/EntityValues.jsx","../src/helpers/validations.jsx","../src/components/EntityComponent/EntityDetails.jsx","../src/helpers/common_constants.jsx","../src/components/IntentComponent/utterance/UtteranceSlotValue.jsx","../src/components/IntentComponent/Dropdown.jsx","../src/components/IntentComponent/utterance/UtteranceInput.jsx","../src/components/IntentComponent/utterance/Utterance.jsx","../src/components/IntentComponent/IntentUtterances.jsx","../src/helpers/useDebounce.jsx","../src/components/IntentComponent/IntentDetails.jsx","../src/index.js"],"sourcesContent":["import React from 'react';\n\nfunction IconTrash() {\n\treturn (\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\">\n\t\t\t<g fill=\"none\" fill-rule=\"evenodd\" stroke=\"#1A1A1A\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n\t\t\t\t<path d=\"M2.4 6.5v7c0 1.105.835 2 1.867 2h7.466c1.032 0 1.867-.895 1.867-2v-7M1.467 3.5h13.066M6.133 3.5v-3h3.734v3M8 7.5v5M10.8 7.5v5M5.2 7.5v5\" />\n\t\t\t</g>\n\t\t</svg>\n\t);\n}\n\nexport { IconTrash };\n","import React, { useState, useRef, useEffect } from 'react';\nimport { IconTrash } from '../../assets/icon_trash.jsx';\n\nconst EntityValue = (props) => {\n\tconst [value, setValue] = useState(props.item.value);\n\tconst [synonyms, setSynonyms] = useState(props.item.synonyms);\n\tconst [newSynonym, setNewSynonym] = useState('');\n\tconst [remove, setRemove] = useState(false);\n\tconst synonymInput = useRef(null);\n\n\tlet active = props.activeValue === props.index;\n\n\tuseEffect(\n\t\t() => {\n\t\t\tprops.handleUpdate([...props.values], props.index, {\n\t\t\t\tvalue: value,\n\t\t\t\tsynonyms: synonyms\n\t\t\t});\n\t\t},\n\t\t[value, synonyms]\n\t);\n\n\tuseEffect(\n\t\t() => {\n\t\t\tif (newSynonym) {\n\t\t\t\tif (synonyms) {\n\t\t\t\t\tsetSynonyms([...synonyms, newSynonym]);\n\t\t\t\t} else {\n\t\t\t\t\tsetSynonyms(newSynonym);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t\t},\n\t\t[newSynonym]\n\t);\n\n\tconst handleNewSynonym = (target) => {\n\t\tif (target.current.value.length > 0) {\n\t\t\tsetNewSynonym(target.current.value);\n\t\t\ttarget.current.value = '';\n\t\t} else {\n\t\t\tsetNewSynonym('');\n\t\t}\n\t};\n\n\t// synonyms\n\tconst removeSynonym = (value) => {\n\t\tlet arr = [...synonyms];\n\t\tlet index = arr.indexOf(value);\n\n\t\tif (index !== -1) {\n\t\t\tarr.splice(index, 1);\n\t\t\tsetSynonyms(arr);\n\t\t}\n\t};\n\n\tconst makeSynonyms = (items, isActive) => {\n\t\tif (items) {\n\t\t\treturn (\n\t\t\t\titems &&\n\t\t\t\titems.map((item, i) => {\n\t\t\t\t\tif (item) {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<div key={i} className=\"synonym\">\n\t\t\t\t\t\t\t\t{item}\n\t\t\t\t\t\t\t\t{isActive &&\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\tclassName=\"synonym__remove\"\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\tremoveSynonym(item);\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t&#10005;\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t</div>)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t};\n\n\tconst handleRemove = (e) => {\n\t\te.stopPropagation();\n\t\tsetRemove(true);\n\t\tsetTimeout(() => {\n\t\t\tprops.removeValue(props.index);\n\t\t\tsetRemove(false);\n\t\t}, 220);\n\t};\n\n\treturn (\n\t\t<li\n\t\t\tclassName={`field field--${active ? 'active' : 'inactive'} field--entity ${remove ? 'field--remove' : ''}`}\n\t\t\tonClick={() => {\n\t\t\t\tprops.setActiveValue(props.index);\n\t\t\t}}\n\t\t>\n\t\t\t<div class=\"field__value\">\n\t\t\t\t{active ?\n\t\t\t\t\t<input\n\t\t\t\t\t\tclassName=\"editor-input\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tdefaultValue={value}\n\t\t\t\t\t\tplaceholder=\"Enter value\"\n\t\t\t\t\t\treadonly\n\t\t\t\t\t\tonChange={(e) => {\n\t\t\t\t\t\t\tsetValue(e.target.value);\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\n\t\t\t\t\t:\n\n\t\t\t\t\t<input\n\t\t\t\t\t\treadOnly\n\t\t\t\t\t\tclassName=\"editor-input\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tdefaultValue={value}\n\t\t\t\t\t\tplaceholder=\"Enter value\"\n\t\t\t\t\t\tonChange={(e) => {\n\t\t\t\t\t\t\tsetValue(e.target.value);\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t}\n\t\t\t</div>\n\t\t\t<div className=\"field__synonyms\">\n\t\t\t\t{makeSynonyms(synonyms, active)}\n\t\t\t\t<input\n\t\t\t\t\tclassName=\"editor-input\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tstyle={{ marginLeft: '0.625rem' }}\n\t\t\t\t\treadonly\n\t\t\t\t\tonKeyDown={(e) => {\n\t\t\t\t\t\tif (e.keyCode == 13) {\n\t\t\t\t\t\t\thandleNewSynonym(synonymInput);\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t\tref={synonymInput}\n\t\t\t\t\tplaceholder=\"Enter synonym\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div className=\"field__actions\">\n\t\t\t\t<button\n\t\t\t\t\tclassName=\"btn--remove btn--remove--main\"\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tonClick={(e) => {\n\t\t\t\t\t\thandleRemove(e);\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<IconTrash />\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</li>\n\t);\n};\n\nexport default EntityValue;\n","import React, { useState, useEffect } from 'react';\nimport EntityValue from './EntityValue.jsx';\n\nfunction EntityValues(props) {\n\tconst [ activeValue, setActiveValue ] = useState(null);\n\n\tfunction handleUpdate(arr, index, item) {\n\t\tarr[index] = {\n\t\t\tvalue: item.value,\n\t\t\tsynonyms: item.synonyms\n\t\t};\n\n\t\tprops.setValues(arr);\n\t}\n\n\tconst makeItems = (items) => {\n\t\tif (items) {\n\t\t\treturn items.map((item, index) => {\n\t\t\t\treturn (\n\t\t\t\t\t<React.Fragment key={index}>\n\t\t\t\t\t\t<EntityValue\n\t\t\t\t\t\t\tindex={index}\n\t\t\t\t\t\t\titem={item}\n\t\t\t\t\t\t\tvalues={props.values}\n\t\t\t\t\t\t\tremoveValue={props.removeValue}\n\t\t\t\t\t\t\thandleUpdate={handleUpdate}\n\t\t\t\t\t\t\tactiveValue={activeValue}\n\t\t\t\t\t\t\tsetActiveValue={setActiveValue}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</React.Fragment>\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t};\n\n\tif (props.values) {\n\t\treturn <div>{makeItems(props.values)}</div>;\n\t} else {\n\t\treturn null\n\t}\n}\n\nexport default EntityValues;\n","export const validateInput = (elem, term, regex, message) => {\n  let reg = new RegExp(regex);\n  if (reg.test(term)) {\n    elem.setCustomValidity('');\n  } else {\n    elem.setCustomValidity(message);\n  }\n  elem.reportValidity();\n\n  return reg.test(term);\n};\n","import React, { useState, useEffect } from 'react';\nimport EntityValues from './EntityValues.jsx';\nimport _ from 'lodash';\nimport { useRef } from 'react';\nimport { validateInput } from '../../helpers/validations.jsx';\n\nfunction EntityDetails(props) {\n\tconst [ entity, setEntity ] = useState(null);\n\tconst [ name, setName ] = useState(null);\n\tconst [ values, setValues ] = useState(null);\n\tconst [ newValue, setNewValue ] = useState(null);\n\tconst [valid, setValid] = useState(true);\n\tconst valueInput = useRef(null);\n\n\tuseEffect(\n\t\t() => {\n\t\t\tif (!entity) {\n\t\t\t\tsetEntity(props.entity);\n\t\t\t}\n\t\t},\n\t\t[ props.entity ]\n\t);\n\n\tuseEffect(\n\t\t() => {\n\t\t\tsetName(props.entity.name);\n\t\t\tsetValues(props.entity.values);\n\t\t},\n\t\t[ entity ]\n\t);\n\n\tuseEffect(\n\t\t() => {\n\t\t\tif (name && values) {\n\t\t\t\tprops.onUpdate({\n\t\t\t\t\tname: name,\n\t\t\t\t\tvalues: values\n\t\t\t\t}, valid);\n\t\t\t}\n\t\t},\n\t\t[ name, values ]\n\t);\n\n\t// add new value to value array\n\tconst addNewValue = () => {\n\t\tlet val = {\n\t\t\tvalue: newValue,\n\t\t\tsynonyms: []\n\t\t};\n\n\t\tlet arr = [...values, val];\n\t\tsetValues(arr);\n\t};\n\n\tconst removeValue = (index) => {\n\t\tlet arr = [ ...values ];\n\t\tif (index !== -1) {\n\t\t\tarr.splice(index, 1);\n\t\t\tsetValues(arr);\n\t\t}\n\t};\n\n\tif (values) {\n\t\treturn (\n\t\t\t<div className=\"convo-details\">\n\t\t\t\t<section className=\"layout--editor-content\">\n\t\t\t\t\t<section className=\"entities-editor\">\n\t\t\t\t\t\t{/* Entity name value */}\n\t\t\t\t\t\t<div className=\"margin--30--large\">\n\t\t\t\t\t\t\t<h3 className=\"margin--10--large\">Entity name</h3>\n\t\t\t\t\t\t\t<form\n\t\t\t\t\t\t\t\tonSubmit={(e) => {\n\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tdefaultValue={name ? name : ''}\n\t\t\t\t\t\t\t\t\tplaceholder=\"Entity name\"\n\t\t\t\t\t\t\t\t\tclassName=\"editor-input input--item-name\"\n\t\t\t\t\t\t\t\t\tonChange={(e) => {\n\t\t\t\t\t\t\t\t\t\tlet message = 'Entity names shall begin with alphabetic characters from a to Z. The entity name may contain multiple underscores per word. Entity names shall not contain any numbers at all or soecial characters other than undersocres.'\n\t\t\t\t\t\t\t\t\t\tlet validate = validateInput(e.target, e.target.value, '^[A-Za-z](_*[A-Za-z])*_*$', message);\n\t\t\t\t\t\t\t\t\t\tsetValid(validate);\n\t\t\t\t\t\t\t\t\t\tsetName(e.target.value);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/* Entity words */}\n\t\t\t\t\t\t<div className=\"margin--50--large\">\n\t\t\t\t\t\t\t<h3 className=\"font--18--large margin--10--large\">Values</h3>\n\t\t\t\t\t\t\t<div className=\"margin--24--large\">\n\t\t\t\t\t\t\t\t<EntityValues values={values} setValues={setValues} removeValue={removeValue} />\n\t\t\t\t\t\t\t\t<form onSubmit={(e) => {\n\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\tif (newValue) {\n\t\t\t\t\t\t\t\t\t\taddNewValue();\n\t\t\t\t\t\t\t\t\t\tsetNewValue(null);\n\t\t\t\t\t\t\t\t\t\tvalueInput.current.value = '';\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}}>\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\tclassName=\"editor-input input--add-field\"\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"Enter reference value\"\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => setNewValue(e.target.value)}\n\t\t\t\t\t\t\t\t\t\tref={valueInput}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</section>\n\t\t\t\t</section>\n\t\t\t</div>\n\t\t);\n\t} else {\n\t\treturn null;\n\t}\n}\n\nexport default EntityDetails;\n","export const getRandomColor = () => {\n\tvar letters = \"0123456789ABCDEF\";\n\tvar color = \"#\";\n\n\tfor (var i = 0; i < 6; i++) {\n\t\tcolor += letters[Math.floor(Math.random() * 16)];\n\t}\n\treturn color;\n};\n\nexport const stringToColor = (value) => {\n\treturn value.getHashCode().intToHSL();\n}\n\nString.prototype.getHashCode = function () {\n\tvar hash = 0;\n\tif (this.length == 0) return hash;\n\tfor (var i = 0; i < this.length; i++) {\n\t\thash = this.charCodeAt(i) + ((hash << 5) - hash);\n\t\thash = hash & hash; // Convert to 32bit integer\n\t}\n\treturn hash;\n};\n\nNumber.prototype.intToHSL = function () {\n\tvar shortened = this % 220;\n\treturn \"hsl(\" + shortened + \",100%, 80%)\";\n};\n\nexport const generateId = (length) => {\n\tvar result           = '';\n\tvar characters       = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\tvar charactersLength = characters.length;\n\tfor ( var i = 0; i < length; i++ ) {\n\t\t result += characters.charAt(Math.floor(Math.random() * charactersLength));\n\t}\n\treturn result;\n}\n\nexport const getCaretCharacterOffsetWithin = (element) => {\n\tvar caretOffset = 0;\n\tvar doc = element.ownerDocument || element.document;\n\tvar win = doc.defaultView || doc.parentWindow;\n\tvar sel;\n\tif (typeof win.getSelection != \"undefined\") {\n\t\tsel = win.getSelection();\n\t\tif (sel.rangeCount > 0) {\n\t\t\tvar range = win.getSelection().getRangeAt(0);\n\t\t\tvar preCaretRange = range.cloneRange();\n\t\t\tpreCaretRange.selectNodeContents(element);\n\t\t\tpreCaretRange.setEnd(range.endContainer, range.endOffset);\n\t\t\tcaretOffset = preCaretRange.toString().length;\n\t\t}\n\t} else if ((sel = doc.selection) && sel.type != \"Control\") {\n\t\tvar textRange = sel.createRange();\n\t\tvar preCaretTextRange = doc.body.createTextRange();\n\t\tpreCaretTextRange.moveToElementText(element);\n\t\tpreCaretTextRange.setEndPoint(\"EndToEnd\", textRange);\n\t\tcaretOffset = preCaretTextRange.text.length;\n\t}\n\treturn caretOffset;\n}\n\nexport const getColor = (index) => {\n\tlet arr = [\n\t\t\"#56ebd3\",\n\t\t\"#fbacf6\",\n\t\t\"#9ee786\",\n\t\t\"#e4b5ff\",\n\t\t\"#c2e979\",\n\t\t\"#20d8fd\",\n\t\t\"#e8d25c\",\n\t\t\"#42edec\",\n\t\t\"#f3c46f\",\n\t\t\"#5cefba\",\n\t\t\"#e8de7a\",\n\t\t\"#7ee8c0\",\n\t\t\"#e8d98c\",\n\t\t\"#88e99a\",\n\t\t\"#cfdd73\",\n\t\t\"#8be8ad\",\n\t\t\"#dff799\",\n\t\t\"#b5eaa1\",\n\t\t\"#c2d681\",\n\t\t\"#b5e287\",\n\t];\n\n\treturn arr[index % arr.length]\n};\n\n// Move caret to a specific point in a DOM element\nexport const setCaretPosition = (el, pos) => {\n\n\t// Loop through all child nodes\n\tfor (var node of el.childNodes) {\n\t\tif (node.nodeType == 3) { // we have a text node\n\t\t\tif (node.length >= pos) {\n\t\t\t\t// finally add our range\n\t\t\t\tvar range = document.createRange(),\n\t\t\t\t\tsel = window.getSelection();\n\t\t\t\trange.setStart(node, pos);\n\t\t\t\trange.collapse(true);\n\t\t\t\tsel.removeAllRanges();\n\t\t\t\tsel.addRange(range);\n\t\t\t\treturn -1; // we are done\n\t\t\t} else {\n\t\t\t\tpos -= node.length;\n\t\t\t}\n\t\t} else {\n\t\t\tpos = setCaretPosition(node, pos);\n\t\t\tif (pos == -1) {\n\t\t\t\treturn -1; // no need to finish the for loop\n\t\t\t}\n\t\t}\n\t}\n\treturn pos; // needed because of recursion stuff\n}\n","import React, { useEffect, useState, useRef } from 'react';\n\nconst UtteranceSlotValue = React.memo((props) => {\n  const [valid, setValid] = useState(true);\n\n  const validateSlotValue = () => {\n    let reg = /^[A-Za-z](_*[A-Za-z])*_*$/\n    setValid(reg.test(props.target.dataset.slotValue))\n  }\n\n  useEffect(() => {\n    validateSlotValue();\n  }, [props])\n\n  return (\n    <input data-valid={valid} pattern=\"^[A-Za-z](_*[A-Za-z])*_*$\" value={props.slotValue} onChange={(e) => {\n      props.target.dataset.slotValue = e.target.value;\n      props.updateRaw();\n    }} />\n\n  )\n})\n\nexport default UtteranceSlotValue;","import React, { useState, useEffect, useRef } from 'react';\nimport useOnclickOutside from 'react-cool-onclickoutside';\nimport TextInput from 'react-autocomplete-input';\nimport 'react-autocomplete-input/dist/bundle.css';\n\nfunction Dropdown(props) {\n\tconst [term, setTerm] = useState('');\n\tconst [entities, setEntities] = useState(props.entities);\n\tconst [allEntities, setAllEntities] = useState(props.entities);\n\tconst [entitiesNames, setEntitiesNames] = useState([]);\n\tconst input = useRef();\n\n\tconst modalRef = useOnclickOutside(() => {\n\t\tprops.setSelection(null);\n\t});\n\n\tconst filterEntities = (str) => {\n\t\tsetTerm(str);\n\t};\n\n\tuseEffect(\n\t\t() => {\n\t\t\tlet arr = entities.flat()\n\t\t\t\t.map((item) => {\n\t\t\t\t\treturn item.name;\n\t\t\t\t})\n\t\t\t\t.filter((item) => item);\n\t\t\tsetEntitiesNames(arr);\n\t\t},\n\t\t[entities]\n\t);\n\n\tif (entities) {\n\n\t\tlet dropdownStyles = {\n\t\t\tposition: 'absolute',\n\t\t\ttop: '100%',\n\t\t\ttransition: 'all 220ms ease-in-out',\n\t\t\tvisibility: props.dropdownState.active ? 'visible' : 'hidden',\n\t\t\topacity: props.dropdownState.active ? '1' : '0',\n\t\t\tleft: props.dropdownState.position\n\t\t}\n\n\t\treturn (\n\t\t\t<div class=\"dropdown\" ref={modalRef} style={dropdownStyles}>\n\t\t\t\t<header className=\"dropdown__header\">\n\t\t\t\t\t<TextInput\n\t\t\t\t\t\tComponent=\"input\"\n\t\t\t\t\t\ttrigger=\"\"\n\t\t\t\t\t\toptions={entitiesNames}\n\t\t\t\t\t\tspaceRemovers={[]}\n\t\t\t\t\t\tmatchAny={true}\n\t\t\t\t\t\tonChange={(e) => {\n\t\t\t\t\t\t\tfilterEntities(e);\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tref={input}\n\t\t\t\t\t\tclassName=\"dropdown__search editor-input\"\n\t\t\t\t\t\tplaceholder=\"Filter entities\"\n\t\t\t\t\t/>\n\t\t\t\t</header>\n\t\t\t\t<div class=\"dropdown__items\">\n\t\t\t\t\t{entities.length && entities.flat().map((item, i) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tstyle={{display: item.name.toLowerCase().includes(term.toLocaleLowerCase().trim()) ? 'block' : 'none'}}\n\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tprops.tagSelection(item.name)\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t@\n\t\t\t\t\t\t\t\t{item.name}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t} else {\n\t\treturn null;\n\t}\n}\n\nexport default Dropdown;\n","import React, { useRef, useEffect, useState } from 'react';\nimport rangy from 'rangy';\nimport ContentEditable from 'react-contenteditable'\nimport { getCaretCharacterOffsetWithin, stringToColor, setCaretPosition } from '../../../helpers/common_constants'\nimport Dropdown from '../Dropdown'\nimport sanitizeHtml from 'sanitize-html';\n\nconst UtteranceInput = (props) => {\n\n  const [dropdownState, setDropdownState] = useState({\n    position: 0,\n    active: false\n  });\n\n  const input = props.input;\n  const cursorPosition = useRef(null);\n\n  function createNode(type, slot_value, text) {\n\n    let mark = document.createElement('mark');\n    let newTextNode = document.createTextNode(text);\n\n    mark.appendChild(newTextNode);\n    mark.textContent = mark.textContent.trim();\n    mark.setAttribute('data-type', type);\n    mark.setAttribute('data-slot-value', slot_value);\n    mark.setAttribute('data-text', mark.textContent.trim());\n    mark.setAttribute('data-color', stringToColor(mark.textContent.trim()));\n    mark.style.background = stringToColor(text);\n\n    return mark;\n  }\n\n  const tagSelection = (type) => {\n    if (props.selection) {\n      if (!props.selection.tagName) {\n\n        const getSlotValue = (type) => {\n          let existingSlotValue = props.slotValuePairs.find(item => item.type === type);\n          console.log('is there --->', existingSlotValue);\n          if (existingSlotValue) {\n            return existingSlotValue.slot_value\n          } else {\n            let arr = type.split('.');\n            let str = arr[arr.length - 1];\n            return str;\n          }\n        }\n      \n        let mark = createNode(type, getSlotValue(type), props.selection.toString());\n        if (mark) {\n          props.selection.getRangeAt(0).extractContents();\n          props.selection.getRangeAt(0).insertNode(mark);\n\n          if (mark.parentElement.tagName === \"MARK\") {\n            mark.parentElement.replaceWith(...mark.parentElement.childNodes);\n            mark.innerHTML = mark.textContent.trim();\n          }\n\n          input.current.childNodes.forEach((item) => {\n            if (item.tagName === \"MARK\") {\n              if (item.innerHTML.slice(-1).includes(' ')) {\n                item.innerHTML = item.innerHTML.trim();\n              }\n            }\n          })\n        }\n      } else {\n        let mark = props.selection;\n        mark.style.outline = \"none\";\n        mark.dataset.type = type;\n      }\n\n\n      let lastChar = input.current.innerHTML[input.current.innerHTML.length - 1];\n      let newRaw = input.current.innerHTML + `${lastChar === ' ' ? '' : ' '}`;\n      props.setRaw(newRaw);\n      props.setSelection(null);\n      cursorPosition.current && setCaretPosition(input.current, cursorPosition.current);\n\n    }\n  }\n\n  const handleSelection = () => {\n    var sel\n    // Check for existence of window.getSelection() and that it has a\n    // modify() method. IE 9 has both selection APIs but no modify() method.\n    if (window.getSelection && (sel = window.getSelection()).modify) {\n      sel = window.getSelection()\n      if (!sel.isCollapsed) {\n        // Detect if selection is backwards\n        var range = document.createRange()\n        range.setStart(sel.anchorNode, sel.anchorOffset)\n        range.setEnd(sel.focusNode, sel.focusOffset)\n        var backwards = range.collapsed\n        range.detach()\n\n        // modify() works on the focus of the selection\n        var endNode = sel.focusNode,\n          endOffset = sel.focusOffset\n        sel.collapse(sel.anchorNode, sel.anchorOffset)\n\n        var direction = []\n        if (backwards) {\n          direction = ['backward', 'forward']\n        } else {\n          direction = ['forward', 'backward']\n        }\n\n        sel.modify('move', direction[0], 'character')\n        sel.modify('move', direction[1], 'word')\n        sel.extend(endNode, endOffset)\n        sel.modify('extend', direction[1], 'character')\n        sel.modify('extend', direction[0], 'word')\n      }\n    }\n\n    /* \n    SET CURRENT SELECTION\n    */\n    if (sel.toString().length > 0) {\n      let sel = rangy.getSelection()\n      props.setSelection(sel)\n    } else {\n      props.setSelection(null);\n    }\n  }\n\n  useEffect(() => {\n    let s = window.getSelection();\n\n    if (s && s.rangeCount > 0) {\n      let oRange = s.getRangeAt(0); //get the text range\n      let oRect = oRange.getBoundingClientRect();\n\n      setDropdownState({\n        position: oRect.x,\n        active: props.selection !== null\n      })\n    } else {\n      setDropdownState({ ...dropdownState, active: false });\n    }\n  }, [props.selection, props.active]);\n\n  const sanitized = sanitizeHtml(props.raw, {\n    allowedTags: ['mark'],\n    allowedAttributes: false,\n    exclusiveFilter: function (frame) {\n      return !frame.text.trim();\n    }\n  });\n\n  return (\n    <div class='taggable-text'>\n      <ContentEditable\n        data-placeholder=\"Enter reference value\"\n        innerRef={input}\n        className='taggable-text__input'\n        html={sanitized}\n        onClick={(e) => {\n          if (e.target.tagName === 'MARK') {\n            props.setSelection(e.target);\n          }\n        }}\n\n        onChange={(e) => {\n          props.setRaw(e.target.value)\n          cursorPosition.current = getCaretCharacterOffsetWithin(input.current);\n        }}\n        onMouseUp={() => {\n          handleSelection();\n          cursorPosition.current = getCaretCharacterOffsetWithin(input.current);\n        }}\n\n        onKeyDown={(e) => {\n          if (e.keyCode === 13 || e.keyCode === 40 || e.keyCode === 38) {\n            e.preventDefault();\n            if (e.keyCode === 13) {\n              document.querySelectorAll('.taggable-text__input')[0].focus();\n            }\n          }\n        }}\n        onKeyUp={(e) => {\n          handleSelection();\n          cursorPosition.current = getCaretCharacterOffsetWithin(input.current);\n        }}\n        onFocus={() => {\n          props.setActive(props.index)\n        }}\n      />\n      {props.active && <Dropdown dropdownState={dropdownState} entities={props.entities} selection={props.selection} setSelection={props.setSelection} tagSelection={tagSelection} />}\n    </div>\n  )\n}\n\nexport default React.memo(UtteranceInput);","import React, { useRef, useState, useEffect } from 'react'\nimport _ from 'lodash'\nimport { stringToColor } from '../../../helpers/common_constants'\nimport { IconTrash } from '../../../assets/icon_trash'\nimport UtteranceSlotValue from './UtteranceSlotValue'\nimport UtteranceInput from './UtteranceInput'\n\nexport const Utterance = React.memo(props => {\n\n    const [raw, setRaw] = useState('');\n    const [selection, setSelection] = useState(null);\n    const [valid, setValid] = useState(true);\n\n    const wrapper = useRef(null);\n    const input = useRef(null);\n\n    const whitelist = input.current && {\n        tags: Array.from(input.current.childNodes).filter(item => item.dataset).map(item => {\n            return ({\n                type: item.dataset.type,\n                slot_value: item.dataset.slotValue,\n                text: item.textContent.trim(),\n                color: item.dataset.color,\n                target: item\n            })\n        }).filter(item => item.text.trim().length),\n        nodes: Array.from(input.current.childNodes).filter(item => item.textContent.trim().length > 0)\n    }\n\n    const active = props.active === props.index;\n\n    useEffect(() => {\n        if (props.utterance.model) {\n            let str = '';\n            if (props.utterance.model.length) {\n                str = props.utterance.model.map(item => {\n                    if (item.type) {\n                        return `<mark data-type=\"${item.type}\" data-slot-value=\"${item.slot_value}\" data-text=\"${item.text}\" data-color=\"${stringToColor(item.text)}\" style=\"background:${stringToColor(item.text)}\">${item.text.trim()}</mark>`\n                    } else {\n                        return item.text.trim()\n                    }\n                }).join(' ');\n            }\n\n\n            let lastChar = str[str.length - 1];\n            setRaw(str + `${lastChar === '>' ? ' ' : ''}`);\n        }\n    }, [props.stateChange]);\n\n    useEffect(() => {\n        let isValid = wrapper.current.querySelectorAll(\"[data-valid='false']\").length < 1;\n\n        setValid(isValid);\n\n        if (whitelist && whitelist.nodes) {\n            let model = whitelist.nodes.map(item => {\n                if (item.dataset) {\n                    return ({\n                        type: item.dataset.type,\n                        text: item.textContent,\n                        slot_value: item.dataset.slotValue\n                    })\n                } else {\n                    return ({ text: item.textContent }\n                    )\n                }\n            }).filter(item => item.text.length)\n\n            let raw = model.map(item => item.text).join(' ');\n            let utterances = [...props.utterances];\n            let newUtterance = { raw: raw, model: model }\n\n            if (!_.isEqual(newUtterance, props.utterance)) {\n                utterances[props.index] = newUtterance;\n                props.setUtterances(utterances)\n            }\n        }\n    }, [whitelist]);\n\n    const validateInput = () => {\n        if (whitelist && whitelist.nodes) {\n            let nodes = whitelist.nodes;\n            let textNodes = nodes.filter(item => !item.tagName);\n\n            if (whitelist.tags.length > 0 && textNodes.length < 1) {\n                return true\n            } else if (textNodes.length > 0) {\n                let str = textNodes.map(item => item.textContent.trim()).join(' ');\n                let reg = /^[a-zA-Z][a-zA-Z/\"/'/`/\\s]*$/;\n                return reg.test(str.trim());\n            } else {\n                return true\n            }\n        } else {\n            return true\n        }\n    }\n\n    const updateRaw = () => {\n        setRaw(input.current.innerHTML);\n    }\n\n    if (props) {\n        return (\n            <React.Fragment>\n                <div ref={wrapper} data-field-valid={`${valid}`} class={`field field--intent ${active ? 'field--active' : ''}`}>\n                    <div\n                        className='field__main'\n                    >\n                        <div className='field__input' data-valid={validateInput() ? 'true' : 'false'}>\n                            <UtteranceInput index={props.index} input={input} active={active} setActive={props.setActive} raw={raw} setRaw={setRaw} entities={props.entities} selection={selection} setSelection={setSelection} slotValuePairs={props.slotValuePairs} />\n                            <div className=\"field__actions\">\n                                {!props.new &&\n                                    <button onClick={() => {\n                                        props.removeFromUtterances(props.utterance);\n                                        document.querySelectorAll('.taggable-text__input')[0].focus();\n                                    }}>\n                                        <IconTrash />\n                                    </button>}\n                            </div>\n                        </div>\n                    </div>\n                    {!props.new && whitelist && whitelist.tags.length > 0 && \n                        <ul className=\"model-list\" style={{ display: active ? 'block' : 'none' }}>\n                            <header className=\"model-list__header\">\n                                <strong>Parameter name</strong>\n                                <strong>Entity</strong>\n                                <strong>Resolved value</strong>\n                            </header>\n                            {whitelist.tags && whitelist.tags.map((item, index) => {\n                                return (\n                                    <li className=\"model-list__item\">\n                                        <UtteranceSlotValue key={index} index={index} target={item.target} slotValue={item.slot_value} whitelist={whitelist} updateRaw={updateRaw} />\n                                        <div><button className=\"mark\" type=\"button\" style={{ background: item.color }} onClick={() => setTimeout(() => { setSelection(item.target) }, 220)}>@{item.type}</button></div>\n                                        <div>{item.text}</div>\n                                    </li>\n                                )\n                            })}\n                        </ul>\n                    }\n                </div>\n            </React.Fragment>\n        )\n    } else {\n        return null\n    }\n})","import React, { useState, useEffect, useRef } from 'react'\nimport { Utterance } from './utterance/Utterance.jsx'\n\nconst IntentUtterances = (props) => {\n\tconst [active, setActive] = useState(null);\n\tconst removeFromUtterances = (object) => {\n\t\tlet arr = props.utterances.filter(item => item !== object);\n\t\tprops.setUtterances(arr);\n\t\tsetActive(null);\n\t\tprops.setStateChange(!props.stateChange)\n\t}\n\n\tif (props.utterances) {\n\t\treturn (\n\t\t\t<ul>\n\t\t\t\t{props.utterances.map((item, index) => {\n\t\t\t\t\tlet isNew = index === 0 && item.model.length === 0;\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<li key={index} style={{ display: item.raw.toLowerCase().includes(props.searchPhrase) ? 'block' : 'none' }}>\n\t\t\t\t\t\t\t<Utterance key={index} utterance={item} new={isNew} index={index} active={active} setActive={setActive} entities={props.entities} removeFromUtterances={removeFromUtterances} utterances={props.utterances} setUtterances={props.setUtterances} stateChange={props.stateChange} setStateChange={props.setStateChange} slotValuePairs={props.slotValuePairs} />\n\t\t\t\t\t\t</li>\n\t\t\t\t\t)\n\t\t\t\t})}\n\t\t\t</ul>\n\t\t)\n\t} else {\n\t\treturn null\n\t}\n}\n\nexport default React.memo(IntentUtterances);\n","import React, { useState, useEffect } from 'react';\n\n// Our hook\nexport default function useDebounce(value, delay) {\n  // State and setters for debounced value\n  const [debouncedValue, setDebouncedValue] = useState(value);\n\n  useEffect(\n    () => {\n      // Set debouncedValue to value (passed in) after the specified delay\n      const handler = setTimeout(() => {\n        setDebouncedValue(value);\n      }, delay);\n\n      // Return a cleanup function that will be called every time ...\n      // ... useEffect is re-called. useEffect will only be re-called ...\n      // ... if value changes (see the inputs array below). \n      // This is how we prevent debouncedValue from changing if value is ...\n      // ... changed within the delay period. Timeout gets cleared and restarted.\n      // To put it in context, if the user is typing within our app's ...\n      // ... search box, we don't want the debouncedValue to update until ...\n      // ... they've stopped typing for more than 500ms.\n      return () => {\n        clearTimeout(handler);\n      };\n    },\n    // Only re-call effect if value changes\n    // You could also add the \"delay\" var to inputs array if you ...\n    // ... need to be able to change that dynamically.\n    [value] \n  );\n\n  return debouncedValue;\n}\n","import React, { useState, useEffect, useCallback } from 'react';\nimport IntentUtterances from './IntentUtterances.jsx';\nimport _, { debounce } from 'lodash';\nimport { useRef } from 'react';\nimport { validateInput } from '../../helpers/validations.jsx';\nimport useDebounce from '../../helpers/useDebounce.jsx';\n\nfunction IntentDetails(props) {\n  const [intent, setIntent] = useState(props.intent);\n  const entities = props.entities;\n  const systemEntities = props.systemEntities;\n  const [stateChange, setStateChange] = useState(false);\n\n  const [name, setName] = useState('');\n  const [utterances, setUtterances] = useState([]);\n\n  const [slotValuePairs, setSlotValuePairs] = useState([]);\n\n  const [valid, setValid] = useState(true);\n  const [searchPhrase, setSearchPhrase] = useState('');\n  const searchInput = useRef(null);\n\n  // check if data is passed in props\n  useEffect(() => {\n    if (intent) {\n      setName(intent.name);\n      setUtterances(intent.utterances);\n    }\n  }, [intent]);\n\n  const handleNew = () => {\n    let newUtteranceField = { raw: '', model: [] };\n    if (utterances[0] && utterances[0].model.length > 0) {\n      let arr = [newUtteranceField, ...utterances];\n      setUtterances(arr);\n      setStateChange(!stateChange);\n\n      let input = document.querySelectorAll('.taggable-text__input')[1];\n      input && input.focus();\n    }\n  }\n\n  const setInitialSlotValuePairs = () => {\n    let arr = utterances.map(item => item.model).flat().filter(item => item.slot_value).map(item => ({\n      type: item.type,\n      slot_value: item.slot_value\n    }));\n\n    console.log(arr)\n\n    setSlotValuePairs(arr);\n  }\n\n  const debouncedHandleNew = useDebounce(handleNew, 300);\n\n  useEffect(() => {\n    debouncedHandleNew;\n    setInitialSlotValuePairs();\n  }, [utterances])\n\n\n  useEffect(() => {\n    if (name && utterances) {\n\n      let intent = {\n        ...intent,\n        name: name,\n        utterances: utterances\n      }\n\n\n      props.onUpdate(intent);\n    }\n  }, [name, utterances]);\n\n  const handleSearch = () => {\n    if (searchInput.current) {\n      let term = searchInput.current.value.toLowerCase().trim();\n      setSearchPhrase(term);\n    }\n  }\n\n  if (utterances.length) {\n    return (\n      <div className=\"convo-details\">\n        <section className=\"layout--editor-content\">\n          <div>\n            {/* Entity name value */}\n            <div className=\"margin--30--large\">\n              <h3 className=\"margin--10--large\">Intent name</h3>\n              <input\n                type=\"text\"\n                defaultValue={name ? name : ''}\n                readonly\n                placeholder=\"Intent name\"\n                className=\"input input--item-name\"\n                onChange={e => {\n                  let message =\n                    'Intent names shall begin with alphabetic characters from a to Z. The intent name may contain 1 underscore per word. Intent names shall not contain any numbers at all.';\n                  validateInput(\n                    e.target,\n                    e.target.value,\n                    '^[A-Za-z](_?[A-Za-z])*_?$',\n                    message\n                  );\n                  setName(e.target.value);\n                }}\n              />\n            </div>\n            {/* Entity words */}\n            <div className=\"margin--50--large\">\n              <div className=\"search-wrapper\">\n                <h3>Utterances</h3>\n                <input ref={searchInput} readonly className=\"input input--search\" type=\"text\" placeholder=\"Search utterances\" onChange={(e) => {\n                  handleSearch();\n                }} />\n              </div>\n              <div className=\"margin--24--large\">\n                <IntentUtterances\n                  utterances={utterances}\n                  setUtterances={setUtterances}\n                  entities={[entities, ...systemEntities]}\n                  stateChange={stateChange}\n                  setStateChange={setStateChange}\n                  searchPhrase={searchPhrase}\n                  slotValuePairs={slotValuePairs}\n                />\n              </div>\n            </div>\n          </div>\n        </section>\n      </div>\n    );\n  } else {\n    return null;\n  }\n}\n\nexport default IntentDetails;\n","import React from 'react'\nimport EntityDetails from './components/EntityComponent/EntityDetails'\nimport IntentDetails from './components/IntentComponent/IntentDetails'\nimport './styles.scss'\n\nexport const IntentEditor = (props) => {\n  return <IntentDetails intent={props.intent} entities={props.entities} systemEntities={props.systemEntities} onUpdate={props.onUpdate} />\n}\n\nexport const EntityEditor = (props) => {\n  return <EntityDetails entity={props.entity} onUpdate={props.onUpdate} />\n}"],"names":["IconTrash","React","EntityValue","props","useState","item","value","setValue","synonyms","setSynonyms","newSynonym","setNewSynonym","remove","setRemove","synonymInput","useRef","active","activeValue","index","useEffect","handleUpdate","values","handleNewSynonym","target","current","length","removeSynonym","arr","indexOf","splice","makeSynonyms","items","isActive","map","i","handleRemove","e","stopPropagation","setTimeout","removeValue","setActiveValue","marginLeft","keyCode","EntityValues","setValues","makeItems","validateInput","elem","term","regex","message","reg","RegExp","test","setCustomValidity","reportValidity","EntityDetails","entity","setEntity","name","setName","newValue","setNewValue","valid","setValid","valueInput","onUpdate","addNewValue","val","preventDefault","validate","stringToColor","getHashCode","intToHSL","String","prototype","hash","charCodeAt","Number","shortened","getCaretCharacterOffsetWithin","element","caretOffset","doc","ownerDocument","document","win","defaultView","parentWindow","sel","getSelection","rangeCount","range","getRangeAt","preCaretRange","cloneRange","selectNodeContents","setEnd","endContainer","endOffset","toString","selection","type","textRange","createRange","preCaretTextRange","body","createTextRange","moveToElementText","setEndPoint","text","setCaretPosition","el","pos","childNodes","node","nodeType","window","setStart","collapse","removeAllRanges","addRange","UtteranceSlotValue","memo","validateSlotValue","dataset","slotValue","updateRaw","Dropdown","setTerm","entities","entitiesNames","setEntitiesNames","input","modalRef","useOnclickOutside","setSelection","filterEntities","str","flat","filter","dropdownStyles","position","top","transition","visibility","dropdownState","opacity","left","display","toLowerCase","includes","toLocaleLowerCase","trim","tagSelection","UtteranceInput","setDropdownState","cursorPosition","createNode","slot_value","mark","createElement","newTextNode","createTextNode","appendChild","textContent","setAttribute","style","background","tagName","getSlotValue","existingSlotValue","slotValuePairs","find","console","log","split","extractContents","insertNode","parentElement","replaceWith","innerHTML","forEach","slice","outline","lastChar","newRaw","setRaw","handleSelection","modify","isCollapsed","anchorNode","anchorOffset","focusNode","focusOffset","backwards","collapsed","detach","endNode","direction","extend","rangy","s","oRange","oRect","getBoundingClientRect","x","sanitized","sanitizeHtml","raw","allowedTags","allowedAttributes","exclusiveFilter","frame","querySelectorAll","focus","setActive","Utterance","wrapper","whitelist","tags","Array","from","color","nodes","utterance","model","join","stateChange","isValid","utterances","newUtterance","_","isEqual","setUtterances","textNodes","removeFromUtterances","IntentUtterances","object","setStateChange","isNew","searchPhrase","useDebounce","delay","debouncedValue","setDebouncedValue","handler","clearTimeout","IntentDetails","intent","systemEntities","setSlotValuePairs","setSearchPhrase","searchInput","handleNew","newUtteranceField","setInitialSlotValuePairs","debouncedHandleNew","handleSearch","IntentEditor","EntityEditor"],"mappings":"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"}