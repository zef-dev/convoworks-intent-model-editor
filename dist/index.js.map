{"version":3,"file":"index.js","sources":["../src/helpers/common_constants.jsx","../src/helpers/image_paths.jsx","../src/components/Icons/Icons.jsx","../src/components/EntityComponent/EntityValue.jsx","../src/components/EntityComponent/EntityValues.jsx","../src/helpers/validations.jsx","../src/components/EntityComponent/EntityDetails.jsx","../src/components/IntentComponent/utterance/UtteranceSlotValue.jsx","../src/components/IntentComponent/Dropdown.jsx","../src/components/IntentComponent/utterance/UtteranceInput.jsx","../src/components/IntentComponent/utterance/Utterance.jsx","../src/components/IntentComponent/IntentUtterances.jsx","../src/components/IntentComponent/IntentDetails.jsx","../src/index.js"],"sourcesContent":["export const getRandomColor = () => {\r\n\tvar letters = \"0123456789ABCDEF\";\r\n\tvar color = \"#\";\r\n\r\n\tfor (var i = 0; i < 6; i++) {\r\n\t\tcolor += letters[Math.floor(Math.random() * 16)];\r\n\t}\r\n\treturn color;\r\n};\r\n\r\nexport const stringToColor = (value) => {\r\n\treturn value.getHashCode().intToHSL();\r\n}\r\n\r\nString.prototype.getHashCode = function () {\r\n\tvar hash = 0;\r\n\tif (this.length == 0) return hash;\r\n\tfor (var i = 0; i < this.length; i++) {\r\n\t\thash = this.charCodeAt(i) + ((hash << 5) - hash);\r\n\t\thash = hash & hash; // Convert to 32bit integer\r\n\t}\r\n\treturn hash;\r\n};\r\n\r\nNumber.prototype.intToHSL = function () {\r\n\tvar shortened = this % 220;\r\n\treturn \"hsl(\" + shortened + \",100%, 80%)\";\r\n};\r\n\r\nexport const generateId = (length) => {\r\n\tvar result = '';\r\n\tvar characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\r\n\tvar charactersLength = characters.length;\r\n\tfor (var i = 0; i < length; i++) {\r\n\t\tresult += characters.charAt(Math.floor(Math.random() * charactersLength));\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nexport const getCaretCharacterOffsetWithin = (element) => {\r\n\tvar caretOffset = 0;\r\n\tvar doc = element.ownerDocument || element.document;\r\n\tvar win = doc.defaultView || doc.parentWindow;\r\n\tvar sel;\r\n\tif (typeof win.getSelection != \"undefined\") {\r\n\t\tsel = win.getSelection();\r\n\t\tif (sel.rangeCount > 0) {\r\n\t\t\tvar range = win.getSelection().getRangeAt(0);\r\n\t\t\tvar preCaretRange = range.cloneRange();\r\n\t\t\tpreCaretRange.selectNodeContents(element);\r\n\t\t\tpreCaretRange.setEnd(range.endContainer, range.endOffset);\r\n\t\t\tcaretOffset = preCaretRange.toString().length;\r\n\t\t}\r\n\t} else if ((sel = doc.selection) && sel.type != \"Control\") {\r\n\t\tvar textRange = sel.createRange();\r\n\t\tvar preCaretTextRange = doc.body.createTextRange();\r\n\t\tpreCaretTextRange.moveToElementText(element);\r\n\t\tpreCaretTextRange.setEndPoint(\"EndToEnd\", textRange);\r\n\t\tcaretOffset = preCaretTextRange.text.length;\r\n\t}\r\n\treturn caretOffset;\r\n}\r\n\r\nexport const getColor = (index) => {\r\n\tlet arr = [\r\n\t\t\"#56ebd3\",\r\n\t\t\"#fbacf6\",\r\n\t\t\"#9ee786\",\r\n\t\t\"#e4b5ff\",\r\n\t\t\"#c2e979\",\r\n\t\t\"#20d8fd\",\r\n\t\t\"#e8d25c\",\r\n\t\t\"#42edec\",\r\n\t\t\"#f3c46f\",\r\n\t\t\"#5cefba\",\r\n\t\t\"#e8de7a\",\r\n\t\t\"#7ee8c0\",\r\n\t\t\"#e8d98c\",\r\n\t\t\"#88e99a\",\r\n\t\t\"#cfdd73\",\r\n\t\t\"#8be8ad\",\r\n\t\t\"#dff799\",\r\n\t\t\"#b5eaa1\",\r\n\t\t\"#c2d681\",\r\n\t\t\"#b5e287\",\r\n\t];\r\n\r\n\treturn arr[index % arr.length]\r\n};\r\n\r\nexport const preventSubmit = (event) => {\r\n\tif (event.keyCode == 13) {\r\n\t\tevent.preventDefault();\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\n// Move caret to a specific point in a DOM element\r\nexport const setCaretPosition = (el, pos) => {\r\n\r\n\t// Loop through all child nodes\r\n\tfor (var node of el.childNodes) {\r\n\t\tif (node.nodeType == 3) { // we have a text node\r\n\t\t\tif (node.length >= pos) {\r\n\t\t\t\t// finally add our range\r\n\t\t\t\tvar range = document.createRange(),\r\n\t\t\t\t\tsel = window.getSelection();\r\n\t\t\t\trange.setStart(node, pos);\r\n\t\t\t\trange.collapse(true);\r\n\t\t\t\tsel.removeAllRanges();\r\n\t\t\t\tsel.addRange(range);\r\n\t\t\t\treturn -1; // we are done\r\n\t\t\t} else {\r\n\t\t\t\tpos -= node.length;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tpos = setCaretPosition(node, pos);\r\n\t\t\tif (pos == -1) {\r\n\t\t\t\treturn -1; // no need to finish the for loop\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn pos; // needed because of recursion stuff\r\n}\r\n","export const intentModelIcon = '../assets/icons/intent_model.svg';\r\nexport const iconSearch = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAABW0lEQVRIid3Uyy5sQRQG4A9DGhMSY7ehW5zZIXEZmnoavAQTvIHwCEJaTMToSPACBggibSgY7LXTrTm7q1sYWEllVWr/l6pVexW/PRaxjUs8xbjAFha+IjyCMl4bjEMMNys+i/sQuMYKxtEZYyLWbgJzj7+p4qN4COIOSgXYbuwG9k7iSfKy7KAtAd+GveAcNAIvqpalaOf10aNarvn6j+018+XI66g0YfCIjTqNT+MydjHWhHgeE8G9KAJVAtTVgkEpuB9O3v4Rm3S5/+O8FBlcRR5swWCoTuNTg3LkpRYMck65CLQgq+ONrIlSoxe3wZ1rBD4M4K60u+jAcXD2U3YzLGv73KSnANtbI/6MPykGMFNjcotVTMp+3xKmsKZalufIZ+hPNRmSvS2Nnut9TOOfaqMNpJqQvS2bOJc1USXmm95faN9XTFKjX1amV5x8h0Fucoqj7zL4+XgDjSNoKGD0WBAAAAAASUVORK5CYII=';\r\nexport const iconTrash = 'data:image/png;base64,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';\r\n","import React from 'react';\r\nimport { ReactSVG } from 'react-svg';\r\nimport { iconTrash } from '../../helpers/image_paths';\r\n\r\n\r\nexport const IconTrash = () => {\r\n  return <img src={iconTrash} alt=\"Remove\" aria-label=\"Remove\" width=\"32\" />\r\n}\r\n\r\nexport const  IconRemove = () => {\r\n\treturn <span role=\"img\" aria-label=\"Remove\">&#x274C;</span>;\r\n}\r\n\r\nexport const  IconSearch = () => {\r\n  return <ReactSVG src={search} />\r\n}\r\n","import React, { useState, useRef, useEffect } from 'react';\r\nimport { preventSubmit } from '../../helpers/common_constants';\r\nimport { IconTrash } from '../Icons/Icons';\r\n\r\nconst EntityValue = (props) => {\r\n\tconst [value, setValue] = useState(props.item.value);\r\n\tconst [synonyms, setSynonyms] = useState(props.item.synonyms);\r\n\tconst [newSynonym, setNewSynonym] = useState('');\r\n\tconst [remove, setRemove] = useState(false);\r\n\tconst synonymInput = useRef(null);\r\n\r\n\tlet active = props.activeValue === props.index;\r\n\r\n\tuseEffect(\r\n\t\t() => {\r\n\t\t\tprops.handleUpdate([...props.values], props.index, {\r\n\t\t\t\tvalue: value,\r\n\t\t\t\tsynonyms: synonyms\r\n\t\t\t});\r\n\t\t},\r\n\t\t[value, synonyms]\r\n\t);\r\n\r\n\tuseEffect(\r\n\t\t() => {\r\n\t\t\tif (newSynonym) {\r\n\t\t\t\tif (synonyms) {\r\n\t\t\t\t\tsetSynonyms([...synonyms, newSynonym]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetSynonyms(newSynonym);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t\t},\r\n\t\t[newSynonym]\r\n\t);\r\n\r\n\tconst handleNewSynonym = (target) => {\r\n\t\tif (target.current.value.length > 0) {\r\n\t\t\tsetNewSynonym(target.current.value);\r\n\t\t\ttarget.current.value = '';\r\n\t\t} else {\r\n\t\t\tsetNewSynonym('');\r\n\t\t}\r\n\t};\r\n\r\n\t// synonyms\r\n\tconst removeSynonym = (value) => {\r\n\t\tlet arr = [...synonyms];\r\n\t\tlet index = arr.indexOf(value);\r\n\r\n\t\tif (index !== -1) {\r\n\t\t\tarr.splice(index, 1);\r\n\t\t\tsetSynonyms(arr);\r\n\t\t}\r\n\t};\r\n\r\n\tconst makeSynonyms = (items, isActive) => {\r\n\t\tif (items) {\r\n\t\t\treturn (\r\n\t\t\t\titems &&\r\n\t\t\t\titems.map((item, i) => {\r\n\t\t\t\t\tif (item) {\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<div key={i} className=\"synonym\">\r\n\t\t\t\t\t\t\t\t{item}\r\n\t\t\t\t\t\t\t\t{isActive &&\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"synonym__remove\"\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tremoveSynonym(item);\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t&#10005;\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</div>)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleRemove = (e) => {\r\n\t\te.stopPropagation();\r\n\t\tsetRemove(true);\r\n\t\tsetTimeout(() => {\r\n\t\t\tprops.removeValue(props.index);\r\n\t\t\tsetRemove(false);\r\n\t\t}, 220);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<li\r\n\t\t\tclassName={`field field--${active ? 'active' : 'inactive'} field--entity ${remove ? 'field--remove' : ''}`}\r\n\t\t\tonClick={() => {\r\n\t\t\t\tprops.setActiveValue(props.index);\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<div className=\"field__value\">\r\n\t\t\t\t{active ?\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tclassName=\"editor-input\"\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tdefaultValue={value}\r\n\t\t\t\t\t\tplaceholder=\"Enter value\"\r\n\t\t\t\t\t\tonKeyDown={(e) => preventSubmit(e)}\r\n\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\tsetValue(e.target.value);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t:\r\n\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tclassName=\"editor-input\"\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tdefaultValue={value}\r\n\t\t\t\t\t\tplaceholder=\"Enter value\"\r\n\t\t\t\t\t\tonKeyDown={(e) => preventSubmit(e)}\r\n\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\tsetValue(e.target.value);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t\t<div className=\"field__synonyms\">\r\n\t\t\t\t{makeSynonyms(synonyms, active)}\r\n\t\t\t\t<input\r\n\t\t\t\t\tclassName=\"editor-input\"\r\n\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\tstyle={{ marginLeft: '0.625rem' }}\r\n\t\t\t\t\tonKeyDown={(e) => {\r\n\t\t\t\t\t\tpreventSubmit(e);\r\n\t\t\t\t\t\tif (e.keyCode == 13) {\r\n\t\t\t\t\t\t\thandleNewSynonym(synonymInput);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tref={synonymInput}\r\n\t\t\t\t\tplaceholder=\"Enter synonym\"\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"field__actions\">\r\n\t\t\t\t<button\r\n\t\t\t\t\tclassName=\"btn--remove btn--remove--main\"\r\n\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\tonClick={(e) => {\r\n\t\t\t\t\t\thandleRemove(e);\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<IconTrash />\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</li>\r\n\t);\r\n};\r\n\r\nexport default EntityValue;\r\n","import React, { useState, useEffect } from 'react';\r\nimport EntityValue from './EntityValue.jsx';\r\n\r\nfunction EntityValues(props) {\r\n  const [activeValue, setActiveValue] = useState(null);\r\n\r\n  function handleUpdate(arr, index, item) {\r\n    arr[index] = {\r\n      value: item.value,\r\n      synonyms: item.synonyms\r\n    };\r\n\r\n    props.setValues(arr);\r\n  }\r\n\r\n  if (props.values) {\r\n    return (\r\n      <div>\r\n        {props.values.map((value, index) => {\r\n          return (\r\n            <EntityValue\r\n              key={`${value.value}_${index}`}\r\n              index={index}\r\n              item={value}\r\n              values={props.values}\r\n              removeValue={props.removeValue}\r\n              handleUpdate={handleUpdate}\r\n              activeValue={activeValue}\r\n              setActiveValue={setActiveValue}\r\n            />\r\n          );\r\n        })}\r\n      </div>\r\n    )\r\n  } else {\r\n    return null\r\n  }\r\n}\r\n\r\nexport default EntityValues;\r\n","export const validateInput = (elem, term, regex, message) => {\r\n  let reg = new RegExp(regex);\r\n  if (reg.test(term)) {\r\n    elem.setCustomValidity('');\r\n  } else {\r\n    elem.setCustomValidity(message);\r\n  }\r\n  elem.reportValidity();\r\n\r\n  return reg.test(term);\r\n};\r\n\r\nexport const simpleValidateInput = (term, regex) => {\r\n  let reg = new RegExp(regex);\r\n  return reg.test(term); \r\n}","import React, { useState, useEffect } from 'react';\r\nimport EntityValues from './EntityValues.jsx';\r\nimport _ from 'lodash';\r\nimport { useRef } from 'react';\r\nimport { validateInput } from '../../helpers/validations.jsx';\r\nimport { preventSubmit } from '../../helpers/common_constants.jsx';\r\n\r\nfunction EntityDetails(props) {\r\n\tconst [entity, setEntity] = useState(null);\r\n\tconst [name, setName] = useState(null);\r\n\tconst [values, setValues] = useState(null);\r\n\tconst [newValue, setNewValue] = useState(null);\r\n\tconst [valid, setValid] = useState(true);\r\n\tconst valueInput = useRef(null);\r\n\r\n\tuseEffect(\r\n\t\t() => {\r\n\t\t\tif (!entity) {\r\n\t\t\t\tsetEntity(props.entity);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[props.entity]\r\n\t);\r\n\r\n\tuseEffect(\r\n\t\t() => {\r\n\t\t\tsetName(props.entity.name);\r\n\t\t\tsetValues(props.entity.values);\r\n\t\t},\r\n\t\t[entity]\r\n\t);\r\n\r\n\tuseEffect(\r\n\t\t() => {\r\n\t\t\tif (name && values) {\r\n\t\t\t\tprops.onUpdate({\r\n\t\t\t\t\tname: name,\r\n\t\t\t\t\tvalues: values\r\n\t\t\t\t}, valid);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[name, values]\r\n\t);\r\n\r\n\t// add new value to value array\r\n\tconst addNewValue = () => {\r\n\t\tlet val = {\r\n\t\t\tvalue: newValue,\r\n\t\t\tsynonyms: []\r\n\t\t};\r\n\r\n\t\tlet arr = [...values, val];\r\n\t\tsetValues(arr);\r\n\t};\r\n\r\n\tconst removeValue = (index) => {\r\n\t\tlet arr = [...values];\r\n    let filteredArr = arr.filter(item => item !== arr[index]);\r\n    setValues(filteredArr);\r\n\t};\r\n\r\n\tif (values) {\r\n\t\treturn (\r\n\t\t\t<div className=\"convo-details\">\r\n\t\t\t\t<section className=\"layout--editor-content\">\r\n\t\t\t\t\t<section className=\"entities-editor\">\r\n\t\t\t\t\t\t{/* Entity name value */}\r\n\t\t\t\t\t\t<div className=\"margin--30--large\">\r\n\t\t\t\t\t\t\t<h3 className=\"margin--10--large\">Entity name</h3>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tdefaultValue={name ? name : ''}\r\n\t\t\t\t\t\t\t\tplaceholder=\"Entity name\"\r\n\t\t\t\t\t\t\t\tclassName=\"editor-input input--item-name\"\r\n\t\t\t\t\t\t\t\tonKeyDown={(e) => preventSubmit(e)}\r\n\t\t\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\t\t\tlet message = 'Entity names shall begin with alphabetic characters from a to Z. The entity name may contain multiple underscores per word. Entity names shall not contain any numbers at all or soecial characters other than undersocres.'\r\n\t\t\t\t\t\t\t\t\tlet validate = validateInput(e.target, e.target.value, '^[A-Za-z](_*[A-Za-z])*_*$', message);\r\n\t\t\t\t\t\t\t\t\tsetValid(validate);\r\n\t\t\t\t\t\t\t\t\tsetName(e.target.value);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/* Entity words */}\r\n\t\t\t\t\t\t<div className=\"margin--50--large\">\r\n\t\t\t\t\t\t\t<h3 className=\"font--18--large margin--10--large\">Values</h3>\r\n\t\t\t\t\t\t\t<div className=\"margin--24--large\">\r\n\t\t\t\t\t\t\t\t<EntityValues values={values} setValues={setValues} removeValue={removeValue} />\r\n\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\tclassName=\"editor-input input--add-field\"\r\n\t\t\t\t\t\t\t\t\tplaceholder=\"Enter reference value\"\r\n\t\t\t\t\t\t\t\t\tonKeyDown={(e) => {\r\n\t\t\t\t\t\t\t\t\t\tpreventSubmit(e);\r\n\t\t\t\t\t\t\t\t\t\tif (e.keyCode === 13) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (newValue) {\r\n\t\t\t\t\t\t\t\t\t\t\t\taddNewValue();\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetNewValue(null);\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalueInput.current.value = '';\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\tonChange={(e) => setNewValue(e.target.value)}\r\n\t\t\t\t\t\t\t\t\tref={valueInput}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</section>\r\n\t\t\t\t</section>\r\n\t\t\t</div>\r\n\t\t);\r\n\t} else {\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\nexport default EntityDetails;\r\n","import React, { useEffect, useState, useRef } from 'react';\r\nimport { preventSubmit } from '../../../helpers/common_constants';\r\n\r\nconst UtteranceSlotValue = React.memo((props) => {\r\n  const input = useRef(input);\r\n  const [valid, setValid] = useState(true);\r\n\r\n  const validateSlotValue = () => {\r\n    let reg = /^[A-Za-z](_*[A-Za-z])*_*$/\r\n    let regTest = reg.test(props.target.dataset.slotValue);\r\n    input.current.setCustomValidity(regTest ? '' : 'Parameter name must not contain spaces or special characters');\r\n    setValid(regTest);\r\n\r\n  }\r\n\r\n  useEffect(() => {\r\n    validateSlotValue();\r\n  }, [props])\r\n\r\n  return (\r\n    <input\r\n      ref={input}\r\n      data-valid={valid}\r\n      value={props.slotValue}\r\n      onKeyDown={(e) => preventSubmit(e)}\r\n      onChange={(e) => {\r\n        props.target.dataset.slotValue = e.target.value;\r\n        props.updateRaw();\r\n      }} />\r\n\r\n  )\r\n})\r\n\r\nexport default UtteranceSlotValue;","import React, { useState, useEffect, useRef } from 'react';\r\nimport useOnclickOutside from 'react-cool-onclickoutside';\r\nimport TextInput from 'react-autocomplete-input';\r\nimport 'react-autocomplete-input/dist/bundle.css';\r\nimport { preventSubmit } from '../../helpers/common_constants';\r\n\r\nfunction Dropdown(props) {\r\n\tconst [term, setTerm] = useState('');\r\n\tconst [entities, setEntities] = useState(props.entities);\r\n\tconst [entitiesNames, setEntitiesNames] = useState([]);\r\n\tconst input = useRef();\r\n\t\r\n\r\n\tconst modalRef = useOnclickOutside(() => {\r\n\t\tprops.setSelection(null);\r\n\t});\r\n\r\n\tconst filterEntities = (str) => {\r\n\t\tsetTerm(str);\r\n\t};\r\n\r\n\tuseEffect(\r\n\t\t() => {\r\n\t\t\tlet arr = entities.flat()\r\n\t\t\t\t.map((item) => {\r\n\t\t\t\t\treturn item.name;\r\n\t\t\t\t})\r\n\t\t\t\t.filter((item) => item);\r\n\t\t\tsetEntitiesNames(arr);\r\n\t\t},\r\n\t\t[entities]\r\n\t);\r\n\r\n\tif (entities) {\r\n\r\n\t\tlet dropdownStyles = {\r\n\t\t\tposition: 'absolute',\r\n\t\t\ttop: '100%',\r\n\t\t\ttransition: 'all 220ms ease-in-out',\r\n\t\t\tvisibility: props.dropdownState.active ? 'visible' : 'hidden',\r\n\t\t\topacity: props.dropdownState.active ? '1' : '0',\r\n\t\t\tleft: props.dropdownState.position\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"dropdown\" ref={modalRef} style={dropdownStyles}>\r\n\t\t\t\t<header className=\"dropdown__header\">\r\n\t\t\t\t\t<TextInput\r\n\t\t\t\t\t\tComponent=\"input\"\r\n\t\t\t\t\t\ttrigger=\"\"\r\n\t\t\t\t\t\toptions={entitiesNames}\r\n\t\t\t\t\t\tspaceRemovers={[]}\r\n\t\t\t\t\t\tmatchAny={true}\r\n\t\t\t\t\t\tonKeyDown={(e) => preventSubmit(e)}\r\n\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\tfilterEntities(e);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tref={input}\r\n\t\t\t\t\t\tclassName=\"dropdown__search editor-input\"\r\n\t\t\t\t\t\tplaceholder=\"Filter entities\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</header>\r\n\t\t\t\t<div className=\"dropdown__items\">\r\n\t\t\t\t\t{entities.length && entities.flat().map((item, i) => {\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tstyle={{display: item.name.toLowerCase().includes(term.toLocaleLowerCase().trim()) ? 'block' : 'none'}}\r\n\t\t\t\t\t\t\t\tkey={i}\r\n\t\t\t\t\t\t\t\ttype=\"button\"\r\n                className={props.selection && props.selection.dataset && props.selection.dataset.type === item.name ? 'active' : ''}\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tprops.tagSelection(item.name)\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t@\r\n\t\t\t\t\t\t\t\t{item.name}\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t})}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t} else {\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\nexport default Dropdown;\r\n","import React, { useRef, useEffect, useState } from 'react';\r\nimport rangy from 'rangy';\r\nimport 'rangy/lib/rangy-textrange';\r\nimport ContentEditable from 'react-contenteditable'\r\nimport { getCaretCharacterOffsetWithin, stringToColor, setCaretPosition } from '../../../helpers/common_constants'\r\nimport Dropdown from '../Dropdown'\r\nimport sanitizeHtml from 'sanitize-html-react';\r\n\r\nconst UtteranceInput = (props) => {\r\n\r\n  const [dropdownState, setDropdownState] = useState({\r\n    position: 0,\r\n    active: false\r\n  });\r\n\r\n  const [keyPress, setKeyPress] = useState('');\r\n\r\n  const input = props.input;\r\n  const cursorPosition = useRef(null);\r\n\r\n  function createNode(type, slot_value, text) {\r\n\r\n    let mark = document.createElement('mark');\r\n    let newTextNode = document.createTextNode(text);\r\n\r\n    mark.appendChild(newTextNode);\r\n    mark.textContent = mark.textContent.trim();\r\n    mark.setAttribute('data-type', type);\r\n    mark.setAttribute('data-slot-value', slot_value);\r\n    mark.setAttribute('data-text', mark.textContent.trim());\r\n    mark.setAttribute('data-color', stringToColor(mark.textContent.trim()));\r\n    mark.style.background = stringToColor(text);\r\n\r\n    return mark;\r\n  }\r\n\r\n  const tagSelection = (type) => {\r\n    if (props.selection) {\r\n      if (!props.selection.tagName) {\r\n\r\n        const getSlotValue = (type) => {\r\n          let existingSlotValue = props.slotValuePairs.find(item => item.type === type);\r\n          if (existingSlotValue) {\r\n            return existingSlotValue.slot_value\r\n          } else {\r\n            let arr = type.split('.');\r\n            let str = arr[arr.length - 1];\r\n            return str;\r\n          }\r\n        }\r\n\r\n        let mark = createNode(type, getSlotValue(type), props.selection.toString());\r\n        if (mark) {\r\n          props.selection.getRangeAt(0).extractContents();\r\n          props.selection.getRangeAt(0).insertNode(mark);\r\n\r\n          if (mark.parentElement.tagName === \"MARK\") {\r\n            mark.parentElement.replaceWith(...mark.parentElement.childNodes);\r\n            mark.innerHTML = mark.textContent.trim();\r\n          }\r\n\r\n          input.current.childNodes.forEach((item) => {\r\n            if (item.tagName === \"MARK\") {\r\n              if (item.innerHTML.slice(-1).includes(' ')) {\r\n                item.innerHTML = item.innerHTML.trim();\r\n              }\r\n            }\r\n          })\r\n        }\r\n      } else {\r\n        let mark = props.selection;\r\n        mark.style.outline = \"none\";\r\n        mark.dataset.type = type;\r\n      }\r\n\r\n\r\n      let lastChar = input.current.innerHTML[input.current.innerHTML.length - 1];\r\n      let newRaw = input.current.innerHTML + `${lastChar === ' ' ? '' : ' '}`;\r\n      props.setRaw(newRaw);\r\n      props.setSelection(null);\r\n      setTimeout(() => {\r\n        cursorPosition.current && setCaretPosition(input.current, cursorPosition.current);\r\n      }, 100)\r\n    }\r\n  }\r\n\r\n  const handleSelection = () => {\r\n    let sel = rangy.getSelection();\r\n    if (sel.toString().trim().length > 0) {\r\n      // expand highlighted text to match whole words\r\n      sel.expand(\"word\", { trim: true }); // use trim to ignore spaces \r\n      props.setSelection(sel)\r\n    } else {\r\n      props.setSelection(null);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    let s = window.getSelection();\r\n\r\n    if (s && s.rangeCount > 0) {\r\n      let oRange = s.getRangeAt(0); //get the text range\r\n      let oRect = oRange.getBoundingClientRect();\r\n\r\n      setDropdownState({\r\n        position: oRect.x / 2,\r\n        active: props.selection !== null\r\n      })\r\n    } else {\r\n      setDropdownState({ ...dropdownState, active: false });\r\n    }\r\n  }, [props.selection, props.active]);\r\n\r\n  const sanitize = (string) => sanitizeHtml(string, {\r\n    allowedTags: ['mark'],\r\n    allowedAttributes: false\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (keyPress === 13) {\r\n      props.handleNew(props.valid);\r\n      setKeyPress('');\r\n    }\r\n  }, [keyPress]);\r\n\r\n  return (\r\n    <div className='taggable-text'>\r\n      <ContentEditable\r\n        data-placeholder=\"Enter reference value\"\r\n        innerRef={input}\r\n        className='taggable-text__input'\r\n        html={props.raw}\r\n        onClick={(e) => {\r\n          if (e.target.tagName === 'MARK') {\r\n            props.setSelection(e.target);\r\n          }\r\n        }}\r\n        onChange={(e) => {\r\n          cursorPosition.current = getCaretCharacterOffsetWithin(input.current);\r\n          props.setRaw(sanitize(e.target.value));\r\n          setCaretPosition(input.current, cursorPosition.current);\r\n        }}\r\n        onMouseUp={() => {\r\n          handleSelection();\r\n        }}\r\n        onKeyDown={(e) => {\r\n          if (e.keyCode === 13 || e.keyCode === 40 || e.keyCode === 38) {\r\n            setKeyPress(e.keyCode);\r\n            e.preventDefault();\r\n          }\r\n        }}\r\n        onKeyUp={(e) => {\r\n          if (e.keyCode === 16) {\r\n            handleSelection();\r\n          }\r\n          cursorPosition.current = getCaretCharacterOffsetWithin(input.current);\r\n        }}\r\n        onFocus={() => {\r\n          props.setActive(props.index)\r\n        }}\r\n      />\r\n      {props.active && <Dropdown dropdownState={dropdownState} entities={props.entities} selection={props.selection} setSelection={props.setSelection} tagSelection={tagSelection} />}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default React.memo(UtteranceInput);","import React, { useRef, useState, useEffect } from 'react'\r\nimport _ from 'lodash'\r\nimport { stringToColor } from '../../../helpers/common_constants'\r\nimport UtteranceSlotValue from './UtteranceSlotValue'\r\nimport UtteranceInput from './UtteranceInput'\r\nimport { IconTrash } from '../../Icons/Icons'\r\nimport reactHtmlParser from 'react-html-parser'\r\n\r\nexport const Utterance = React.memo(props => {\r\n  const [raw, setRaw] = useState('');\r\n  const [selection, setSelection] = useState(null);\r\n  const [valid, setValid] = useState(true);\r\n  const [validationMessage, setValidationMessage] = useState('');\r\n\r\n  const wrapper = useRef(null);\r\n  const inputWrapper = useRef(null);\r\n  const input = useRef(null);\r\n\r\n  const whitelist = input.current && {\r\n    tags: Array.from(input.current.childNodes).filter(item => item.dataset).map(item => {\r\n      return ({\r\n        type: item.dataset.type,\r\n        slot_value: item.dataset.slotValue,\r\n        text: item.textContent.trim(),\r\n        color: item.dataset.color,\r\n        target: item\r\n      })\r\n    }).filter(item => item.text.trim().length > 0 && item.type),\r\n    nodes: Array.from(input.current.childNodes).filter(item => item.textContent.trim().length > 0)\r\n  }\r\n\r\n  const active = props.active === props.index;\r\n\r\n  useEffect(() => {\r\n    if (props.utterance.model) {\r\n      let str = '';\r\n      if (props.utterance.model.length) {\r\n        str = props.utterance.model.map(item => {\r\n          if (item.type) {\r\n            return `<mark data-type=\"${item.type}\" data-slot-value=\"${item.slot_value}\" data-color=\"${stringToColor(item.text)}\" style=\"background:${stringToColor(item.text)}\">${item.text.trim()}</mark>`\r\n          } else {\r\n            return item.text.trim()\r\n          }\r\n        }).join(' ');\r\n      }\r\n\r\n\r\n      let lastChar = str[str.length - 1];\r\n      setRaw(str + `${lastChar === '>' ? ' ' : ''}`);\r\n    }\r\n  }, [props.stateChange]);\r\n\r\n  useEffect(() => {\r\n    let isValid = wrapper.current.querySelectorAll(\"[data-valid='false']\").length < 1;\r\n    setValid(isValid);\r\n\r\n    if (whitelist && whitelist.nodes) {\r\n      let model = whitelist.nodes.map(item => {\r\n        if (item.dataset) {\r\n          return ({\r\n            type: item.dataset.type,\r\n            text: item.textContent.trim(),\r\n            slot_value: item.dataset.slotValue\r\n          })\r\n        } else {\r\n          return ({ text: item.textContent.trim() }\r\n          )\r\n        }\r\n      }).filter(item => item.text.length);\r\n\r\n      let raw = model.map(item => item.text).join(' ');\r\n      let utterances = [...props.utterances];\r\n      let newUtterance = { raw: raw, model: model }\r\n\r\n      if (!_.isEqual(newUtterance, props.utterance)) {\r\n        utterances[props.index] = newUtterance;\r\n        props.setUtterances(utterances)\r\n      }\r\n    }\r\n  }, [whitelist]);\r\n\r\n  const handleValidationMessage = (message) => {\r\n    if (validationMessage !== message) setValidationMessage(message);\r\n  }\r\n\r\n  const validateInput = () => {\r\n    if (whitelist && whitelist.nodes) {\r\n      let nodes = whitelist.nodes;\r\n      let textNodes = nodes.filter(item => !item.tagName);\r\n      let nodesMappedToString = nodes.map(item => {\r\n        if (item.dataset && item.dataset.type) return `${item.textContent.trim()} {${item.dataset.type}}`\r\n        return item.textContent.trim()\r\n      }).join(' ');\r\n\r\n      let intentsWithDuplicateUtterances = props.allUtterancesInIntents.filter(item => item.string === nodesMappedToString);\r\n      if (intentsWithDuplicateUtterances.length > 1 && nodes.length > 0) {\r\n        handleValidationMessage(`Utterance must be unique across intents. This utterance appears in <strong>${intentsWithDuplicateUtterances[0].intent}</strong>.`);\r\n        return false\r\n      } else\r\n        if (textNodes.length > 0) {\r\n          let str = textNodes.map(item => item.textContent.trim()).join(' ');\r\n          let reg = /^[a-zA-Z][a-zA-Z/\\s/./_/'/-]*$/;\r\n          let strValid = reg.test(str.trim())\r\n          handleValidationMessage(strValid ? '' : \"Utterance can't contain special characters\");\r\n          return strValid;\r\n        } else {\r\n          handleValidationMessage('');\r\n          return true\r\n        }\r\n    } else {\r\n      handleValidationMessage('');\r\n      return false\r\n    }\r\n  }\r\n\r\n  const updateRaw = () => {\r\n    setRaw(input.current.innerHTML);\r\n  }\r\n\r\n  if (props) {\r\n    return (\r\n      <React.Fragment>\r\n        <div ref={wrapper} data-field-valid={`${valid}`} className={`field field--intent ${active ? 'field--active' : ''}`}>\r\n          <div\r\n            className='field__main'\r\n          >\r\n            <div ref={inputWrapper} className='field__input' data-valid={validateInput() ? 'true' : 'false'}>\r\n              <UtteranceInput index={props.index} input={input} active={active} setActive={props.setActive} utterances={props.utterances} raw={raw} setRaw={setRaw} entities={props.entities} selection={selection} setSelection={setSelection} slotValuePairs={props.slotValuePairs} handleNew={props.handleNew} valid={valid} />\r\n              <div className=\"field__actions\">\r\n                {props.index !== 0 && props.utterances.length > 1 &&\r\n                  <button type=\"button\" onClick={() => {\r\n                    props.removeFromUtterances(props.utterance);\r\n                    document.querySelectorAll('.taggable-text__input')[0].focus();\r\n                  }}>\r\n                    <IconTrash />\r\n                  </button>}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          {!props.new && whitelist && whitelist.tags.length > 0 &&\r\n            <ul className=\"model-list\" style={{ display: active ? 'block' : 'none' }}>\r\n              <header className=\"model-list__header\">\r\n                <strong>Parameter name</strong>\r\n                <strong>Entity</strong>\r\n                <strong>Resolved value</strong>\r\n              </header>\r\n              {whitelist.tags && whitelist.tags.map((item, index) => {\r\n                if (item.target && item.type) return (\r\n                  <li className=\"model-list__item\" key={index}>\r\n                    <UtteranceSlotValue key={index} index={index} target={item.target} slotValue={item.slot_value} whitelist={whitelist} updateRaw={updateRaw} />\r\n                    <div>\r\n                      <button className=\"mark\" type=\"button\" style={{ background: item.color }} onClick={() => setSelection(item.target) }>\r\n                        {item.type && item.type[0] === '@' ? '' : '@'}{item.type}\r\n                      </button>\r\n                    </div>\r\n                    <div>{item.text}</div>\r\n                  </li>\r\n                )\r\n              })}\r\n            </ul>\r\n          }\r\n          {validationMessage.length > 0 && <p className=\"field__error\">{reactHtmlParser(validationMessage)}</p>}\r\n        </div>\r\n      </React.Fragment>\r\n    )\r\n  } else {\r\n    return null\r\n  }\r\n})","import React, { useState, useEffect, useRef } from 'react'\r\nimport { Utterance } from './utterance/Utterance.jsx'\r\n\r\nconst IntentUtterances = (props) => {\r\n  const [active, setActive] = useState(null);\r\n  const removeFromUtterances = (object) => {\r\n    let arr = props.utterances.filter(item => item !== object);\r\n    props.setUtterances(arr);\r\n    setActive(null);\r\n    props.setStateChange(!props.stateChange)\r\n  }\r\n\r\n\r\n  const handleNew = (valid) => {\r\n    if (valid) {\r\n      if (props.utterances[0].model.length > 0) {\r\n\r\n        let newUtteranceField = { raw: '', model: [] };\r\n        let arr = [newUtteranceField, ...props.utterances];\r\n\r\n        props.setUtterances(arr);\r\n        props.setStateChange(!props.stateChange);\r\n      }\r\n\r\n      setTimeout(() => {\r\n        let input = document.querySelectorAll('.taggable-text__input')[0];\r\n        input && input.focus();\r\n      }, 100);\r\n    }\r\n  }\r\n\r\n  if (props.utterances) {\r\n    return (\r\n      <ul>\r\n        {props.utterances.map((item, index) => {\r\n          return (\r\n            <li key={index} style={{ display: item.raw.toLowerCase().includes(props.searchPhrase) ? 'block' : 'none' }}>\r\n              <Utterance key={index} allUtterancesInIntents={props.allUtterancesInIntents} utterances={props.utterances} utterance={item} index={index} active={active} setActive={setActive} entities={props.entities} removeFromUtterances={removeFromUtterances} utterances={props.utterances} setUtterances={props.setUtterances} stateChange={props.stateChange} setStateChange={props.setStateChange} slotValuePairs={props.slotValuePairs} handleNew={handleNew} />\r\n            </li>\r\n          )\r\n        })}\r\n      </ul>\r\n    )\r\n  } else {\r\n    return null\r\n  }\r\n}\r\n\r\nexport default React.memo(IntentUtterances);\r\n","import React, { useState, useEffect } from 'react';\r\nimport IntentUtterances from './IntentUtterances.jsx';\r\nimport _, { property } from 'lodash';\r\nimport { simpleValidateInput, validateInput } from '../../helpers/validations.jsx';\r\n\r\nimport { preventSubmit } from '../../helpers/common_constants.jsx';\r\nimport { iconSearch } from '../../helpers/image_paths.jsx';\r\n\r\nfunction IntentDetails(props) {\r\n\r\n  const [intent] = useState(props.intent);\r\n  const entities = props.entities;\r\n  const systemEntities = props.systemEntities;\r\n  const [stateChange, setStateChange] = useState(false);\r\n  const [name, setName] = useState('');\r\n  const [utterances, setUtterances] = useState([]);\r\n  const [slotValuePairs, setSlotValuePairs] = useState([]);\r\n  const [searchPhrase, setSearchPhrase] = useState('');\r\n\r\n  // check if data is passed in props\r\n  useEffect(() => {\r\n    if (intent) {\r\n      setName(intent.name);\r\n      if (intent.utterances.length) {\r\n        /* add new field if only one utterance is present */\r\n        setUtterances([{ raw: '', model: [] }, ...intent.utterances.filter(item => item.model.length > 0)]);\r\n      } else {\r\n        setUtterances([{ raw: '', model: [] }])\r\n      }\r\n    }\r\n  }, [intent]);\r\n\r\n  const setInitialSlotValuePairs = () => {\r\n    let arr = utterances.map(item => item.model).flat().filter(item => item.slot_value).map(item => ({\r\n      type: item.type,\r\n      slot_value: item.slot_value\r\n    }));\r\n\r\n    setSlotValuePairs(arr);\r\n  }\r\n\r\n  useEffect(() => {\r\n    setInitialSlotValuePairs();\r\n  }, [utterances]);\r\n\r\n\r\n  useEffect(() => {\r\n    if (name && utterances) {\r\n      // TODO: using a timeout is really hacky -> do better\r\n      setTimeout(() => {\r\n        const valid = document.querySelectorAll('[data-field-valid=\"false\"]').length < 1;\r\n        let updatedIntent = {\r\n          name: name,\r\n          utterances: utterances.filter(item => item.model.length),\r\n          type: intent.type || 'custom'\r\n        }\r\n\r\n        props.onUpdate(updatedIntent, valid);\r\n      }, 10)\r\n    }\r\n  }, [name, utterances]);\r\n\r\n  const handleSearch = (term) => {\r\n    setSearchPhrase(term);\r\n  }\r\n\r\n  const handleNameChange = (e) => {\r\n    let message =\r\n      'Intent names shall begin with alphabetic characters from a to Z. The intent name may contain 1 underscore per word. Intent names shall not contain any numbers at all.';\r\n    let isTextValid = simpleValidateInput(e.target.value, '^[A-Za-z](_?[A-Za-z])*_?$');\r\n    let doesSameIntentNameExist = props.intents.filter(item => (item.name === e.target.value) && item !== intent).length > 0;\r\n\r\n    if (!isTextValid) {\r\n      e.target.setCustomValidity(message);\r\n    } else if (doesSameIntentNameExist) {\r\n      e.target.setCustomValidity('Intent name must be unique')\r\n    } else {\r\n      e.target.setCustomValidity('');\r\n    }\r\n\r\n    e.target.reportValidity();\r\n    setName(e.target.value);\r\n  }\r\n\r\n  const mapUtterancesAsString = (model) => {\r\n    return model.map(item => {\r\n      if (item.type) return `${item.text} {${item.type}}`\r\n      return item.text\r\n    }).join(' ');\r\n  }\r\n\r\n  if (intent && props.intents) { \r\n\r\n    const outsideIntentUtterances = props.intents.filter(obj => obj.name !== intent.name).map(intent => intent.utterances.map(utterance => ({ intent: intent.name, string: mapUtterancesAsString(utterance.model) }))).flat();\r\n    const currentIntentUtterances = utterances.map(utterance => ({ intent: intent.name, string: mapUtterancesAsString(utterance.model) }));\r\n    const allUtterancesInIntents = [...outsideIntentUtterances, ...currentIntentUtterances];\r\n\r\n    return (\r\n      <div className=\"convo-details\">\r\n        <section className=\"layout--editor-content\">\r\n          <div>\r\n            {/* Entity name value */}\r\n            <div className=\"margin--30--large\">\r\n              <h3 className=\"margin--10--large\">Intent name</h3>\r\n              <input\r\n                type=\"text\"\r\n                defaultValue={name ? name : ''}\r\n                placeholder=\"Intent name\"\r\n                className=\"input input--item-name\"\r\n                onKeyDown={(e) => preventSubmit(e)}\r\n                onChange={e => handleNameChange(e)}\r\n              />\r\n            </div>\r\n            {/* Entity words */}\r\n            <div className=\"margin--50--large\">\r\n              <div className=\"search-wrapper\">\r\n                <h3>Utterances</h3>\r\n                <input\r\n                  style={{ background: `url(${iconSearch}) no-repeat 12px center`, backgroundSize: '18px', paddingLeft: '42px' }}\r\n                  className=\"input input--search\"\r\n                  type=\"text\" placeholder=\"Search utterances\"\r\n                  onChange={(e) => {\r\n                    handleSearch(e.target.value);\r\n                  }}\r\n                  onKeyDown={(e) => preventSubmit(e)}\r\n                />\r\n              </div>\r\n              <div className=\"margin--24--large\">\r\n                <IntentUtterances\r\n                  intents={props.intents}\r\n                  allUtterancesInIntents={allUtterancesInIntents}\r\n                  utterances={utterances}\r\n                  setUtterances={setUtterances}\r\n                  entities={[entities, ...systemEntities]}\r\n                  stateChange={stateChange}\r\n                  setStateChange={setStateChange}\r\n                  searchPhrase={searchPhrase}\r\n                  slotValuePairs={slotValuePairs}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </section>\r\n      </div>\r\n    );\r\n  } else {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport default IntentDetails;\r\n","import React from 'react'\r\nimport EntityDetails from './components/EntityComponent/EntityDetails'\r\nimport IntentDetails from './components/IntentComponent/IntentDetails'\r\nimport './styles.scss'\r\n\r\nexport const IntentEditor = (props) => {\r\n  return <IntentDetails intents={props.intents} intent={props.intent} entities={props.entities} systemEntities={props.systemEntities} onUpdate={props.onUpdate} />\r\n}\r\n\r\nexport const EntityEditor = (props) => {\r\n  return <EntityDetails entity={props.entity} onUpdate={props.onUpdate} />\r\n}"],"names":["stringToColor","value","getHashCode","intToHSL","String","prototype","hash","length","i","charCodeAt","Number","shortened","getCaretCharacterOffsetWithin","element","caretOffset","doc","ownerDocument","document","win","defaultView","parentWindow","sel","getSelection","rangeCount","range","getRangeAt","preCaretRange","cloneRange","selectNodeContents","setEnd","endContainer","endOffset","toString","selection","type","textRange","createRange","preCaretTextRange","body","createTextRange","moveToElementText","setEndPoint","text","preventSubmit","event","keyCode","preventDefault","setCaretPosition","el","pos","childNodes","node","nodeType","window","setStart","collapse","removeAllRanges","addRange","iconSearch","iconTrash","IconTrash","React","EntityValue","props","useState","item","setValue","synonyms","setSynonyms","newSynonym","setNewSynonym","remove","setRemove","synonymInput","useRef","active","activeValue","index","useEffect","handleUpdate","values","handleNewSynonym","target","current","removeSynonym","arr","indexOf","splice","makeSynonyms","items","isActive","map","handleRemove","e","stopPropagation","setTimeout","removeValue","setActiveValue","marginLeft","EntityValues","setValues","validateInput","elem","term","regex","message","reg","RegExp","test","setCustomValidity","reportValidity","simpleValidateInput","EntityDetails","entity","setEntity","name","setName","newValue","setNewValue","valid","setValid","valueInput","onUpdate","addNewValue","val","filteredArr","filter","validate","UtteranceSlotValue","memo","input","validateSlotValue","regTest","dataset","slotValue","updateRaw","Dropdown","setTerm","entities","entitiesNames","setEntitiesNames","modalRef","useOnclickOutside","setSelection","filterEntities","str","flat","dropdownStyles","position","top","transition","visibility","dropdownState","opacity","left","display","toLowerCase","includes","toLocaleLowerCase","trim","tagSelection","UtteranceInput","setDropdownState","keyPress","setKeyPress","cursorPosition","createNode","slot_value","mark","createElement","newTextNode","createTextNode","appendChild","textContent","setAttribute","style","background","tagName","getSlotValue","existingSlotValue","slotValuePairs","find","split","extractContents","insertNode","parentElement","replaceWith","innerHTML","forEach","slice","outline","lastChar","newRaw","setRaw","handleSelection","rangy","expand","s","oRange","oRect","getBoundingClientRect","x","sanitize","string","sanitizeHtml","allowedTags","allowedAttributes","handleNew","raw","setActive","Utterance","validationMessage","setValidationMessage","wrapper","inputWrapper","whitelist","tags","Array","from","color","nodes","utterance","model","join","stateChange","isValid","querySelectorAll","utterances","newUtterance","_","isEqual","setUtterances","handleValidationMessage","textNodes","nodesMappedToString","intentsWithDuplicateUtterances","allUtterancesInIntents","intent","strValid","removeFromUtterances","focus","reactHtmlParser","IntentUtterances","object","setStateChange","newUtteranceField","searchPhrase","IntentDetails","systemEntities","setSlotValuePairs","setSearchPhrase","setInitialSlotValuePairs","updatedIntent","handleSearch","handleNameChange","isTextValid","doesSameIntentNameExist","intents","mapUtterancesAsString","outsideIntentUtterances","obj","currentIntentUtterances","backgroundSize","paddingLeft","IntentEditor","EntityEditor"],"mappings":"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"}