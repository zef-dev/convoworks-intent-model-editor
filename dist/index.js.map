{"version":3,"file":"index.js","sources":["../src/helpers/common_constants.jsx","../src/helpers/image_paths.jsx","../src/components/Icons/Icons.jsx","../src/components/EntityComponent/EntityValue.jsx","../src/components/EntityComponent/EntityValues.jsx","../src/helpers/validations.jsx","../src/components/EntityComponent/EntityDetails.jsx","../src/components/IntentComponent/utterance/UtteranceSlotValue.jsx","../src/components/IntentComponent/Dropdown.jsx","../src/components/IntentComponent/utterance/UtteranceInput.jsx","../src/components/IntentComponent/utterance/Utterance.jsx","../src/components/IntentComponent/IntentUtterances.jsx","../src/components/IntentComponent/IntentDetails.jsx","../src/index.js"],"sourcesContent":["export const getRandomColor = () => {\r\n\tvar letters = \"0123456789ABCDEF\";\r\n\tvar color = \"#\";\r\n\r\n\tfor (var i = 0; i < 6; i++) {\r\n\t\tcolor += letters[Math.floor(Math.random() * 16)];\r\n\t}\r\n\treturn color;\r\n};\r\n\r\nexport const stringToColor = (value) => {\r\n\treturn value.toLowerCase().getHashCode().intToHSL();\r\n}\r\n\r\nString.prototype.getHashCode = function () {\r\n\tvar hash = 0;\r\n\tif (this.length == 0) return hash;\r\n\tfor (var i = 0; i < this.length; i++) {\r\n\t\thash = this.charCodeAt(i) + ((hash << 5) - hash);\r\n\t\thash = hash & hash; // Convert to 32bit integer\r\n\t}\r\n\treturn hash;\r\n};\r\n\r\nNumber.prototype.intToHSL = function () {\r\n\tvar shortened = this % 220;\r\n\treturn \"hsl(\" + shortened + \",100%, 80%)\";\r\n};\r\n\r\nexport const generateId = (length) => {\r\n\tvar result = '';\r\n\tvar characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\r\n\tvar charactersLength = characters.length;\r\n\tfor (var i = 0; i < length; i++) {\r\n\t\tresult += characters.charAt(Math.floor(Math.random() * charactersLength));\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nexport const getCaretCharacterOffsetWithin = (element) => {\r\n\tvar caretOffset = 0;\r\n\tvar doc = element.ownerDocument || element.document;\r\n\tvar win = doc.defaultView || doc.parentWindow;\r\n\tvar sel;\r\n\tif (typeof win.getSelection != \"undefined\") {\r\n\t\tsel = win.getSelection();\r\n\t\tif (sel.rangeCount > 0) {\r\n\t\t\tvar range = win.getSelection().getRangeAt(0);\r\n\t\t\tvar preCaretRange = range.cloneRange();\r\n\t\t\tpreCaretRange.selectNodeContents(element);\r\n\t\t\tpreCaretRange.setEnd(range.endContainer, range.endOffset);\r\n\t\t\tcaretOffset = preCaretRange.toString().length;\r\n\t\t}\r\n\t} else if ((sel = doc.selection) && sel.type != \"Control\") {\r\n\t\tvar textRange = sel.createRange();\r\n\t\tvar preCaretTextRange = doc.body.createTextRange();\r\n\t\tpreCaretTextRange.moveToElementText(element);\r\n\t\tpreCaretTextRange.setEndPoint(\"EndToEnd\", textRange);\r\n\t\tcaretOffset = preCaretTextRange.text.length;\r\n\t}\r\n\treturn caretOffset;\r\n}\r\n\r\nexport const getColor = (index) => {\r\n\tlet arr = [\r\n\t\t\"#56ebd3\",\r\n\t\t\"#fbacf6\",\r\n\t\t\"#9ee786\",\r\n\t\t\"#e4b5ff\",\r\n\t\t\"#c2e979\",\r\n\t\t\"#20d8fd\",\r\n\t\t\"#e8d25c\",\r\n\t\t\"#42edec\",\r\n\t\t\"#f3c46f\",\r\n\t\t\"#5cefba\",\r\n\t\t\"#e8de7a\",\r\n\t\t\"#7ee8c0\",\r\n\t\t\"#e8d98c\",\r\n\t\t\"#88e99a\",\r\n\t\t\"#cfdd73\",\r\n\t\t\"#8be8ad\",\r\n\t\t\"#dff799\",\r\n\t\t\"#b5eaa1\",\r\n\t\t\"#c2d681\",\r\n\t\t\"#b5e287\",\r\n\t];\r\n\r\n\treturn arr[index % arr.length]\r\n};\r\n\r\nexport const preventSubmit = (event) => {\r\n\tif (event.keyCode == 13) {\r\n\t\tevent.preventDefault();\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\n// Move caret to a specific point in a DOM element\r\nexport const setCaretPosition = (el, pos) => {\r\n\r\n\t// Loop through all child nodes\r\n\tfor (var node of el.childNodes) {\r\n\t\tif (node.nodeType == 3) { // we have a text node\r\n\t\t\tif (node.length >= pos) {\r\n\t\t\t\t// finally add our range\r\n\t\t\t\tvar range = document.createRange(),\r\n\t\t\t\t\tsel = window.getSelection();\r\n\t\t\t\trange.setStart(node, pos);\r\n\t\t\t\trange.collapse(true);\r\n\t\t\t\tsel.removeAllRanges();\r\n\t\t\t\tsel.addRange(range);\r\n\t\t\t\treturn -1; // we are done\r\n\t\t\t} else {\r\n\t\t\t\tpos -= node.length;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tpos = setCaretPosition(node, pos);\r\n\t\t\tif (pos == -1) {\r\n\t\t\t\treturn -1; // no need to finish the for loop\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn pos; // needed because of recursion stuff\r\n}\r\n","export const intentModelIcon = '../assets/icons/intent_model.svg';\r\nexport const iconSearch = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAABW0lEQVRIid3Uyy5sQRQG4A9DGhMSY7ehW5zZIXEZmnoavAQTvIHwCEJaTMToSPACBggibSgY7LXTrTm7q1sYWEllVWr/l6pVexW/PRaxjUs8xbjAFha+IjyCMl4bjEMMNys+i/sQuMYKxtEZYyLWbgJzj7+p4qN4COIOSgXYbuwG9k7iSfKy7KAtAd+GveAcNAIvqpalaOf10aNarvn6j+018+XI66g0YfCIjTqNT+MydjHWhHgeE8G9KAJVAtTVgkEpuB9O3v4Rm3S5/+O8FBlcRR5swWCoTuNTg3LkpRYMck65CLQgq+ONrIlSoxe3wZ1rBD4M4K60u+jAcXD2U3YzLGv73KSnANtbI/6MPykGMFNjcotVTMp+3xKmsKZalufIZ+hPNRmSvS2Nnut9TOOfaqMNpJqQvS2bOJc1USXmm95faN9XTFKjX1amV5x8h0Fucoqj7zL4+XgDjSNoKGD0WBAAAAAASUVORK5CYII=';\r\nexport const iconTrash = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAHYcAAB2HAGnwnjqAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAB35JREFUeJzt3W+IHPUZB/DvM3u7Oe+yt70zl97MrtwlSETOEuFU0kJjX0TT+KKYiAQRFAqCIuSFxapR8cS/7YuC0lctCBZFpTUBKQZtwD+teEYPDO29CUeSi7Mz1xzcedkU0113Hl/c+sbszmzmN3s7m+f5vMzvN8/v2fl9WWYvszuEHmXb9jgRvQhgD4BCl9pYBXCEmR/1fX+hSz0YoW43EIfjOFcBOAZgrNu9NCwCuMnzvK+63cilsrrdQEzTSM/mA2u9THe7iTh6NQC7ut1AE2nsKVKvBmCo2w00kcaeIvVqAFRCNADCaQCE6+t2A52Qy+WGT58+/XWSNScmJn5UrVZXkqyZBvoOIJwGQDgNgHAaAOE0AMJpAITTAAinARBOAyCcBkA4DYBwGgDhNADCaQCE0wAI19Zt4WNjY3ssy3oCwI0Asp1tSRmqAfg8CIJnFxcXj0RNjgyA4zh3AXi9nbkqVRjA3Z7nvRE2KXRTJycncysrKy6A0SQ7U+tmaXh4uDQ3N1dtNSH0GmB1dfV66Ob3stHGHrakF4HChQagUCh8CWBpnXpRyVtq7GFLmdCjl5bq+XzeBbAPehHYaxjAfSdPnjweNik0AABQqVT+Mzg4eIyItmDtS5CRx6iuqgH4LAiC+33fP9ztZpRSSimllFJKKaWUUkoppZRSSim1/ozv8imVSiP1ev05IroDQIGIPiWiadd1PzRvT32vVCr9gpmnmfmnAFaZ+e1MJvO467rLJnWNAjA6Oroxm83OAJj8wVDdsqxfua77rkl9taZUKt0WBME7uPhurLlarbZjaWnpfNzaRncF9/X1HcDFmw8AmSAI/gi9jzAJ1DiXzW7Fm2zsQWxGASCisN/I31Iqla42qa+Axjnc0mo8Yg8imX4vIPQ38uv1ek/+hn6atHEOjc6xfjFEOA2AcBoA4VL9vIBisXgPMz8E4CcAFojolbGxsd/Nzs7WDOtuA/ACM98CAET0DwCPlcvlEyZ1p6amsouLi48w868BjAP4NxH9oVwu/8Wkbiel9h3Atu2DzPwqgO1Y63MLMz/j+/5bJnWLxeI2Zp5h5n0A8gDyzLyPmWcawYjN9/23mPkZrF21WwC2M/Ortm0fNKnbSakMwPj4uE1ET7UY3mvb9m6D8i8AGG7y78ONsVgaPe1tNkZET42Pj9txa3dSKgNQq9VuBpBrNW7y2ZeZWx4bNhYloqdc4zWlTioDwMyhn22JyOSzb9ixsetG9RT1mrollQFQ60cDIJwGQDgNgHAaAOE0AMJpAITTAAinARBOAyCcBkA4DYBwGgDhNADCaQCE0wAIpwEQTgMgnAZAOA2AcBoA4TQAwmkAhNMACKcBEE4DIJwGQDgNgHAaAOE0AMJpAITTAAinARBOAyCcBkA4DYBwGgDhNADCaQCES2UAiOhc2Dgzh45HCDs2dt2onqJeU7ekMgDZbPYjANVW48x8NG5tImp5bNhYlIieqo3XlDqpDMDCwoLPzE+3GD7s+/57BuUfA7DS5N9XGmOxNHo63GyMmZ9eWFjw49bupFQGAAB833+eiO4FcBxAAOAUET1p2/Z+k7rlcvkEEe0gokMAKgAqRHSIiHaY/ly8bdv7iehJAKcaPR8nont933/epG4nGT3Vy3GcLwBMtRpn5ht83581WUM627aniOiLkCmznufdELd+at8B1PrQAAinARDONAChz+6xLCtrWF88ItoQMaXlx+V2mAagEjZIRCOG9RVwZcR46B5EMX107H/Dxpn5WpP6CgBwTdggMy+aFDcKADPPR4zfalJfAQBCz6FlWaF7EMU0ADMRU3Zu2rQpb7KGZCMjI0MAdobNaWMPQhkFYHBw8EMAYc+u78/lcg+YrCHZhg0bHgQQdhH4v4GBgY9N1jAKwPz8/P8BfBAx7eFGktUl2Lp1a4GIfhMx7WhjD2Iz/jsAM/89Ysqm/v7+P5muI82FCxf+jOhPAFHnPpJxAIjoNQBRV6L7Hcf5relaUjiO8wiAOyOm+ZZlvW66Vsa0QKVSqQ0NDQUAoh7neks+nx+pVCrvA2DTdS9T5DjONIBn25j7eLlc/sR4QdMCADAxMdFfrVbnARSj5jLzsUwmc8B13c+SWPtyUSwWr2fmlwH8vI3pnmVZV7uu+43puokEAABs295LRG+3WbMO4F0i+huAGSL6KokX00tKpdIVzHwVgJ8x8x0A9qC9d2QGcLvnee8k0UdiAQAAx3F+D+DhJGuqi7zoeV7sO5d+KNEAAOgrFotHmTmVT8rudUT0Ublc3gXg26RqJv3fwd8S0T4A/0q4rgL+mclk9iLBzQc6cD+A67rLAwMDuwC8mXRtqYjokGVZu8+cOdPsZlYjxh8Dm1leXq5XKpXDGzduzBDRjk6tI0AVwHOe5z147ty50Hsv4urkxvD58+c/KBQKbzKzDWCyg2tdjo4GQXC77/t/RQf/bpL0RWBLjuPcCuAAgF9C3xFaqQM4AuAlz/Nif0nlUqxbAL63efPmH2ez2d3MvBPAdQAmAAwBuGK9e+myb7D2VbRTAOaI6ONarfbe2bNnQ2+ySdp3+FYNrwQ0lLEAAAAASUVORK5CYII=';\r\n","import React from 'react';\r\nimport { ReactSVG } from 'react-svg';\r\nimport { iconTrash } from '../../helpers/image_paths';\r\n\r\n\r\nexport const IconTrash = () => {\r\n  return <img src={iconTrash} alt=\"Remove\" aria-label=\"Remove\" width=\"32\" />\r\n}\r\n\r\nexport const  IconRemove = () => {\r\n\treturn <span role=\"img\" aria-label=\"Remove\">&#x274C;</span>;\r\n}\r\n\r\nexport const  IconSearch = () => {\r\n  return <ReactSVG src={search} />\r\n}\r\n","import React, { useState, useRef, useEffect } from 'react';\r\nimport { preventSubmit } from '../../helpers/common_constants';\r\nimport { IconTrash } from '../Icons/Icons';\r\n\r\nconst EntityValue = (props) => {\r\n\tconst [value, setValue] = useState(props.item.value);\r\n\tconst [synonyms, setSynonyms] = useState(props.item.synonyms);\r\n\tconst [newSynonym, setNewSynonym] = useState('');\r\n\tconst [remove, setRemove] = useState(false);\r\n\tconst synonymInput = useRef(null);\r\n\r\n\tlet active = props.activeValue === props.index;\r\n\r\n\tuseEffect(\r\n\t\t() => {\r\n\t\t\tprops.handleUpdate([...props.values], props.index, {\r\n\t\t\t\tvalue: value,\r\n\t\t\t\tsynonyms: synonyms\r\n\t\t\t});\r\n\t\t},\r\n\t\t[value, synonyms]\r\n\t);\r\n\r\n\tuseEffect(\r\n\t\t() => {\r\n\t\t\tif (newSynonym) {\r\n\t\t\t\tif (synonyms) {\r\n\t\t\t\t\tsetSynonyms([...synonyms, newSynonym]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetSynonyms([newSynonym]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t\t},\r\n\t\t[newSynonym]\r\n\t);\r\n\r\n\tconst handleNewSynonym = (target) => {\r\n\t\tif (target.current.value.length > 0) {\r\n\t\t\tsetNewSynonym(target.current.value);\r\n\t\t\ttarget.current.value = '';\r\n\t\t} else {\r\n\t\t\tsetNewSynonym('');\r\n\t\t}\r\n\t};\r\n\r\n\t// synonyms\r\n\tconst removeSynonym = (value) => {\r\n\t\tlet arr = [...synonyms];\r\n\t\tlet index = arr.indexOf(value);\r\n\r\n\t\tif (index !== -1) {\r\n\t\t\tarr.splice(index, 1);\r\n\t\t\tsetSynonyms(arr);\r\n\t\t}\r\n\t};\r\n\r\n\tconst makeSynonyms = (items, isActive) => {\r\n\t\tif (items) {\r\n\t\t\treturn (\r\n\t\t\t\titems &&\r\n\t\t\t\titems.map((item, i) => {\r\n\t\t\t\t\tif (item) {\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<div key={i} className=\"synonym\">\r\n\t\t\t\t\t\t\t\t{item}\r\n\t\t\t\t\t\t\t\t{isActive &&\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"synonym__remove\"\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tremoveSynonym(item);\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t&#10005;\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</div>)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleRemove = (e) => {\r\n\t\te.stopPropagation();\r\n\t\tsetRemove(true);\r\n\t\tsetTimeout(() => {\r\n\t\t\tprops.removeValue(props.index);\r\n\t\t\tsetRemove(false);\r\n\t\t}, 220);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<li\r\n\t\t\tclassName={`field field--${active ? 'active' : 'inactive'} field--entity ${remove ? 'field--remove' : ''}`}\r\n\t\t\tonClick={() => {\r\n\t\t\t\tprops.setActiveValue(props.index);\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<div className=\"field__value\">\r\n\t\t\t\t{active ?\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tclassName=\"editor-input\"\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tdefaultValue={value}\r\n\t\t\t\t\t\tplaceholder=\"Enter value\"\r\n\t\t\t\t\t\tonKeyDown={(e) => preventSubmit(e)}\r\n\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\tsetValue(e.target.value);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t:\r\n\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tclassName=\"editor-input\"\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tdefaultValue={value}\r\n\t\t\t\t\t\tplaceholder=\"Enter value\"\r\n\t\t\t\t\t\tonKeyDown={(e) => preventSubmit(e)}\r\n\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\tsetValue(e.target.value);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t\t<div className=\"field__synonyms\">\r\n\t\t\t\t{makeSynonyms(synonyms, active)}\r\n\t\t\t\t<input\r\n\t\t\t\t\tclassName=\"editor-input\"\r\n\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\tstyle={{ marginLeft: '0.625rem' }}\r\n\t\t\t\t\tonKeyDown={(e) => {\r\n\t\t\t\t\t\tpreventSubmit(e);\r\n\t\t\t\t\t\tif (e.keyCode == 13) {\r\n\t\t\t\t\t\t\thandleNewSynonym(synonymInput);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tref={synonymInput}\r\n\t\t\t\t\tplaceholder=\"Enter synonym\"\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"field__actions\">\r\n\t\t\t\t<button\r\n\t\t\t\t\tclassName=\"btn--remove btn--remove--main\"\r\n\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\tonClick={(e) => {\r\n\t\t\t\t\t\thandleRemove(e);\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<IconTrash />\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</li>\r\n\t);\r\n};\r\n\r\nexport default EntityValue;\r\n","import React, { useState, useEffect } from 'react';\r\nimport EntityValue from './EntityValue.jsx';\r\n\r\nfunction EntityValues(props) {\r\n  const [activeValue, setActiveValue] = useState(null);\r\n\r\n  function handleUpdate(arr, index, item) {\r\n    arr[index] = {\r\n      value: item.value,\r\n      synonyms: item.synonyms\r\n    };\r\n\r\n    props.setValues(arr);\r\n  }\r\n\r\n  if (props.values) {\r\n    return (\r\n      <div>\r\n        {props.values.map((value, index) => {\r\n          return (\r\n            <EntityValue\r\n              key={`${value.value}_${index}`}\r\n              index={index}\r\n              item={value}\r\n              values={props.values}\r\n              removeValue={props.removeValue}\r\n              handleUpdate={handleUpdate}\r\n              activeValue={activeValue}\r\n              setActiveValue={setActiveValue}\r\n            />\r\n          );\r\n        })}\r\n      </div>\r\n    )\r\n  } else {\r\n    return null\r\n  }\r\n}\r\n\r\nexport default EntityValues;\r\n","export const validateInput = (elem, term, regex, message) => {\r\n  let reg = new RegExp(regex);\r\n  if (reg.test(term)) {\r\n    elem.setCustomValidity('');\r\n  } else {\r\n    elem.setCustomValidity(message);\r\n  }\r\n  elem.reportValidity();\r\n\r\n  return reg.test(term);\r\n};\r\n\r\nexport const simpleValidateInput = (term, regex) => {\r\n  let reg = new RegExp(regex);\r\n  return reg.test(term); \r\n}","import React, { useState, useEffect } from 'react';\r\nimport EntityValues from './EntityValues.jsx';\r\nimport _ from 'lodash';\r\nimport { useRef } from 'react';\r\nimport { validateInput } from '../../helpers/validations.jsx';\r\nimport { preventSubmit } from '../../helpers/common_constants.jsx';\r\n\r\nfunction EntityDetails(props) {\r\n\tconst [entity, setEntity] = useState(null);\r\n\tconst [name, setName] = useState(null);\r\n\tconst [values, setValues] = useState(null);\r\n\tconst [newValue, setNewValue] = useState(null);\r\n\tconst [valid, setValid] = useState(true);\r\n\tconst valueInput = useRef(null);\r\n\r\n\tuseEffect(\r\n\t\t() => {\r\n\t\t\tif (!entity) {\r\n\t\t\t\tsetEntity(props.entity);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[props.entity]\r\n\t);\r\n\r\n\tuseEffect(\r\n\t\t() => {\r\n\t\t\tsetName(props.entity.name);\r\n\t\t\tsetValues(props.entity.values);\r\n\t\t},\r\n\t\t[entity]\r\n\t);\r\n\r\n\tuseEffect(\r\n\t\t() => {\r\n\t\t\tif (name && values) {\r\n\t\t\t\tprops.onUpdate({\r\n\t\t\t\t\tname: name,\r\n\t\t\t\t\tvalues: values\r\n\t\t\t\t}, valid);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[name, values]\r\n\t);\r\n\r\n\t// add new value to value array\r\n\tconst addNewValue = () => {\r\n\t\tlet val = {\r\n\t\t\tvalue: newValue,\r\n\t\t\tsynonyms: []\r\n\t\t};\r\n\r\n\t\tlet arr = [...values, val];\r\n\t\tsetValues(arr);\r\n\t};\r\n\r\n\tconst removeValue = (index) => {\r\n\t\tlet arr = [...values];\r\n\t\tlet filteredArr = arr.filter(item => item !== arr[index]);\r\n\t\tsetValues(filteredArr);\r\n\t};\r\n\r\n\tif (values) {\r\n\t\treturn (\r\n\t\t\t<div className=\"convo-details\">\r\n\t\t\t\t<section className=\"layout--editor-content\">\r\n\t\t\t\t\t<section className=\"entities-editor\">\r\n\t\t\t\t\t\t{/* Entity name value */}\r\n\t\t\t\t\t\t<div className=\"margin--30--large\">\r\n\t\t\t\t\t\t\t<h3 className=\"margin--10--large\">Entity name</h3>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tdefaultValue={name ? name : ''}\r\n\t\t\t\t\t\t\t\tplaceholder=\"Entity name\"\r\n\t\t\t\t\t\t\t\tclassName=\"editor-input input--item-name\"\r\n\t\t\t\t\t\t\t\tonKeyDown={(e) => preventSubmit(e)}\r\n\t\t\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\t\t\tlet message = 'Entity names shall begin with alphabetic characters from a to Z. The entity name may contain multiple underscores per word. Entity names shall not contain any numbers at all or soecial characters other than undersocres.'\r\n\t\t\t\t\t\t\t\t\tlet validate = validateInput(e.target, e.target.value, '^[A-Za-z](_*[A-Za-z])*_*$', message);\r\n\t\t\t\t\t\t\t\t\tsetValid(validate);\r\n\t\t\t\t\t\t\t\t\tsetName(e.target.value);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/* Entity words */}\r\n\t\t\t\t\t\t<div className=\"margin--50--large\">\r\n\t\t\t\t\t\t\t<h3 className=\"font--18--large margin--10--large\">Values</h3>\r\n\t\t\t\t\t\t\t<div className=\"margin--24--large\">\r\n\t\t\t\t\t\t\t\t<EntityValues values={values} setValues={setValues} removeValue={removeValue} />\r\n\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\tclassName=\"editor-input input--add-field\"\r\n\t\t\t\t\t\t\t\t\tplaceholder=\"Enter reference value\"\r\n\t\t\t\t\t\t\t\t\tonKeyDown={(e) => {\r\n\t\t\t\t\t\t\t\t\t\tpreventSubmit(e);\r\n\t\t\t\t\t\t\t\t\t\tif (e.keyCode === 13) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (newValue) {\r\n\t\t\t\t\t\t\t\t\t\t\t\taddNewValue();\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetNewValue(null);\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalueInput.current.value = '';\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\tonChange={(e) => setNewValue(e.target.value)}\r\n\t\t\t\t\t\t\t\t\tref={valueInput}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</section>\r\n\t\t\t\t</section>\r\n\t\t\t</div>\r\n\t\t);\r\n\t} else {\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\nexport default EntityDetails;\r\n","import React, { useEffect, useState, useRef } from 'react';\r\nimport { preventSubmit } from '../../../helpers/common_constants';\r\n\r\nconst UtteranceSlotValue = React.memo((props) => {\r\n  const input = useRef(input);\r\n  const [valid, setValid] = useState(true);\r\n\r\n  const validateSlotValue = () => {\r\n    let reg = /^[A-Za-z](_*[A-Za-z])*_*$/\r\n    let regTest = reg.test(props.target.dataset.slotValue);\r\n    input.current.setCustomValidity(regTest ? '' : 'Parameter name must not contain spaces or special characters');\r\n    setValid(regTest);\r\n\r\n  }\r\n\r\n  useEffect(() => {\r\n    validateSlotValue();\r\n  }, [props])\r\n\r\n  return (\r\n    <input\r\n      ref={input}\r\n      data-valid={valid}\r\n      value={props.slotValue}\r\n      onKeyDown={(e) => preventSubmit(e)}\r\n      onChange={(e) => {\r\n        props.target.dataset.slotValue = e.target.value;\r\n        props.updateRaw();\r\n      }} />\r\n\r\n  )\r\n})\r\n\r\nexport default UtteranceSlotValue;","import React, { useState, useEffect, useRef } from 'react';\r\nimport useOnclickOutside from 'react-cool-onclickoutside';\r\nimport TextInput from 'react-autocomplete-input';\r\nimport 'react-autocomplete-input/dist/bundle.css';\r\nimport { preventSubmit } from '../../helpers/common_constants';\r\n\r\nfunction Dropdown(props) {\r\n\tconst [term, setTerm] = useState('');\r\n\tconst [entities, setEntities] = useState(props.entities);\r\n\tconst [entitiesNames, setEntitiesNames] = useState([]);\r\n\tconst input = useRef();\r\n\t\r\n\r\n\tconst modalRef = useOnclickOutside(() => {\r\n\t\tprops.setSelection(null);\r\n\t});\r\n\r\n\tconst filterEntities = (str) => {\r\n\t\tsetTerm(str);\r\n\t};\r\n\r\n\tuseEffect(\r\n\t\t() => {\r\n\t\t\tlet arr = entities.flat()\r\n\t\t\t\t.map((item) => {\r\n\t\t\t\t\treturn item.name;\r\n\t\t\t\t})\r\n\t\t\t\t.filter((item) => item);\r\n\t\t\tsetEntitiesNames(arr);\r\n\t\t},\r\n\t\t[entities]\r\n\t);\r\n\r\n\tif (entities) {\r\n\r\n\t\tlet dropdownStyles = {\r\n\t\t\tposition: 'absolute',\r\n\t\t\ttop: '100%',\r\n\t\t\ttransition: 'all 220ms ease-in-out',\r\n\t\t\tvisibility: props.dropdownState.active ? 'visible' : 'hidden',\r\n\t\t\topacity: props.dropdownState.active ? '1' : '0',\r\n\t\t\tleft: props.dropdownState.position\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"dropdown\" ref={modalRef} style={dropdownStyles}>\r\n\t\t\t\t<header className=\"dropdown__header\">\r\n\t\t\t\t\t<TextInput\r\n\t\t\t\t\t\tComponent=\"input\"\r\n\t\t\t\t\t\ttrigger=\"\"\r\n\t\t\t\t\t\toptions={entitiesNames}\r\n\t\t\t\t\t\tspaceRemovers={[]}\r\n\t\t\t\t\t\tmatchAny={true}\r\n\t\t\t\t\t\tonKeyDown={(e) => preventSubmit(e)}\r\n\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\tfilterEntities(e);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tref={input}\r\n\t\t\t\t\t\tclassName=\"dropdown__search editor-input\"\r\n\t\t\t\t\t\tplaceholder=\"Filter entities\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</header>\r\n\t\t\t\t<div className=\"dropdown__items\">\r\n\t\t\t\t\t{entities.length && entities.flat().map((item, i) => {\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tstyle={{display: item.name.toLowerCase().includes(term.toLocaleLowerCase().trim()) ? 'block' : 'none'}}\r\n\t\t\t\t\t\t\t\tkey={i}\r\n\t\t\t\t\t\t\t\ttype=\"button\"\r\n                className={props.selection && props.selection.dataset && props.selection.dataset.type === item.name ? 'active' : ''}\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tprops.tagSelection(item.name)\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t@\r\n\t\t\t\t\t\t\t\t{item.name}\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t})}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t} else {\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\nexport default Dropdown;\r\n","import React, { useRef, useEffect, useState } from 'react';\r\nimport rangy from 'rangy';\r\nimport 'rangy/lib/rangy-textrange';\r\nimport ContentEditable from 'react-contenteditable'\r\nimport { getCaretCharacterOffsetWithin, stringToColor, setCaretPosition } from '../../../helpers/common_constants'\r\nimport Dropdown from '../Dropdown'\r\nimport sanitizeHtml from 'sanitize-html-react';\r\n\r\nconst UtteranceInput = (props) => {\r\n\r\n  const [dropdownState, setDropdownState] = useState({\r\n    position: 0,\r\n    active: false\r\n  });\r\n\r\n  const [keyPress, setKeyPress] = useState('');\r\n\r\n  const input = props.input;\r\n  const cursorPosition = useRef(null);\r\n\r\n  function createNode(type, slot_value, text) {\r\n\r\n    let mark = document.createElement('mark');\r\n    let newTextNode = document.createTextNode(text);\r\n\r\n    mark.appendChild(newTextNode);\r\n    mark.textContent = mark.textContent.trim();\r\n    mark.setAttribute('data-type', type);\r\n    mark.setAttribute('data-slot-value', slot_value);\r\n    mark.setAttribute('data-text', mark.textContent.trim());\r\n    mark.setAttribute('data-color', stringToColor(mark.textContent.trim()));\r\n    mark.style.background = stringToColor(text);\r\n\r\n    return mark;\r\n  }\r\n\r\n  const tagSelection = (type) => {\r\n    if (props.selection) {\r\n      if (!props.selection.tagName) {\r\n\r\n        const getSlotValue = (type) => {\r\n          let existingSlotValue = props.slotValuePairs.find(item => item.type === type);\r\n          if (existingSlotValue) {\r\n            return existingSlotValue.slot_value\r\n          } else {\r\n            let arr = type.split('.');\r\n            let str = arr[arr.length - 1];\r\n            return str;\r\n          }\r\n        }\r\n\r\n        let mark = createNode(type, getSlotValue(type), props.selection.toString());\r\n        if (mark) {\r\n          props.selection.getRangeAt(0).extractContents();\r\n          props.selection.getRangeAt(0).insertNode(mark);\r\n\r\n          if (mark.parentElement.tagName === \"MARK\") {\r\n            mark.parentElement.replaceWith(...mark.parentElement.childNodes);\r\n            mark.innerHTML = mark.textContent.trim();\r\n          }\r\n\r\n          input.current.childNodes.forEach((item) => {\r\n            if (item.tagName === \"MARK\") {\r\n              if (item.innerHTML.slice(-1).includes(' ')) {\r\n                item.innerHTML = item.innerHTML.trim();\r\n              }\r\n            }\r\n          })\r\n        }\r\n      } else {\r\n        let mark = props.selection;\r\n        mark.style.outline = \"none\";\r\n        mark.dataset.type = type;\r\n      }\r\n\r\n\r\n      let lastChar = input.current.innerHTML[input.current.innerHTML.length - 1];\r\n      let newRaw = input.current.innerHTML + `${lastChar === ' ' ? '' : ' '}`;\r\n      props.setRaw(newRaw);\r\n      props.setSelection(null);\r\n      setTimeout(() => {\r\n        cursorPosition.current && setCaretPosition(input.current, cursorPosition.current);\r\n      }, 100)\r\n    }\r\n  }\r\n\r\n  const handleSelection = () => {\r\n    let sel = rangy.getSelection();\r\n    if (sel.toString().trim().length > 0) {\r\n      // expand highlighted text to match whole words\r\n      sel.expand(\"word\", { trim: true }); // use trim to ignore spaces \r\n      props.setSelection(sel)\r\n    } else {\r\n      props.setSelection(null);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    let s = window.getSelection();\r\n\r\n    if (s && s.rangeCount > 0) {\r\n      let oRange = s.getRangeAt(0); //get the text range\r\n      let oRect = oRange.getBoundingClientRect();\r\n\r\n      setDropdownState({\r\n        position: oRect.x / 2,\r\n        active: props.selection !== null\r\n      })\r\n    } else {\r\n      setDropdownState({ ...dropdownState, active: false });\r\n    }\r\n  }, [props.selection, props.active]);\r\n\r\n  const sanitize = (string) => sanitizeHtml(string, {\r\n    allowedTags: ['mark'],\r\n    allowedAttributes: false\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (keyPress === 13) {\r\n      props.handleNew(props.valid);\r\n      setKeyPress('');\r\n    }\r\n  }, [keyPress]);\r\n\r\n  return (\r\n    <div className='taggable-text'>\r\n      <ContentEditable\r\n        data-placeholder=\"Enter reference value\"\r\n        innerRef={input}\r\n        className='taggable-text__input'\r\n        html={props.raw}\r\n        onClick={(e) => {\r\n          if (e.target.tagName === 'MARK') {\r\n            props.setSelection(e.target);\r\n          }\r\n        }}\r\n        onChange={(e) => {\r\n          cursorPosition.current = getCaretCharacterOffsetWithin(input.current);\r\n          props.setRaw(sanitize(e.target.value));\r\n          setCaretPosition(input.current, cursorPosition.current);\r\n        }}\r\n        onMouseUp={() => {\r\n          handleSelection();\r\n        }}\r\n        onKeyDown={(e) => {\r\n          if (e.keyCode === 13 || e.keyCode === 40 || e.keyCode === 38) {\r\n            setKeyPress(e.keyCode);\r\n            e.preventDefault();\r\n          }\r\n        }}\r\n        onKeyUp={(e) => {\r\n          if (e.keyCode === 16) {\r\n            handleSelection();\r\n          }\r\n          cursorPosition.current = getCaretCharacterOffsetWithin(input.current);\r\n        }}\r\n        onFocus={() => {\r\n          props.setActive(props.index)\r\n        }}\r\n      />\r\n      {props.active && <Dropdown dropdownState={dropdownState} entities={props.entities} selection={props.selection} setSelection={props.setSelection} tagSelection={tagSelection} />}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default React.memo(UtteranceInput);","import React, { useRef, useState, useEffect } from 'react'\r\nimport _ from 'lodash'\r\nimport { stringToColor } from '../../../helpers/common_constants'\r\nimport UtteranceSlotValue from './UtteranceSlotValue'\r\nimport UtteranceInput from './UtteranceInput'\r\nimport { IconTrash } from '../../Icons/Icons'\r\nimport reactHtmlParser from 'react-html-parser'\r\n\r\nexport const Utterance = React.memo(props => {\r\n  \r\n  const OK = {valid:true,message:''};\r\n  \r\n  const [raw, setRaw] = useState('');\r\n  const [selection, setSelection] = useState(null);\r\n  const [valid, setValid] = useState(true);\r\n  const [validationResult, setValidationResult] = useState( OK);\r\n\r\n  const wrapper = useRef(null);\r\n  const inputWrapper = useRef(null);\r\n  const input = useRef(null);\r\n  \r\n\r\n  const whitelist = input.current && {\r\n    tags: Array.from(input.current.childNodes).filter(item => item.dataset).map(item => {\r\n      return ({\r\n        type: item.dataset.type,\r\n        slot_value: item.dataset.slotValue,\r\n        text: item.textContent.trim(),\r\n        color: item.dataset.color,\r\n        target: item\r\n      })\r\n    }).filter(item => item.text.trim().length > 0 && item.type),\r\n    nodes: Array.from(input.current.childNodes).filter(item => item.textContent.trim().length > 0)\r\n  }\r\n\r\n  const active = props.active === props.index;\r\n\r\n  useEffect(() => {\r\n    if (props.utterance.model) {\r\n      let str = '';\r\n      if (props.utterance.model.length) {\r\n        str = props.utterance.model.map(item => {\r\n          if (item.type) {\r\n            return `<mark data-type=\"${item.type}\" data-slot-value=\"${item.slot_value}\" data-color=\"${stringToColor(item.text)}\" style=\"background:${stringToColor(item.text)}\">${item.text.trim()}</mark>`\r\n          } else {\r\n            return item.text.trim()\r\n          }\r\n        }).join(' ');\r\n      }\r\n\r\n\r\n      let lastChar = str[str.length - 1];\r\n      setRaw(str + `${lastChar === '>' ? ' ' : ''}`);\r\n    }\r\n  }, [props.stateChange]);\r\n\r\n  useEffect(() => {\r\n    let isValid = wrapper.current.querySelectorAll(\"[data-valid='false']\").length < 1;\r\n    setValid(isValid);\r\n\r\n    if (whitelist && whitelist.nodes) {\r\n      let model = whitelist.nodes.map(item => {\r\n        if (item.dataset) {\r\n          return ({\r\n            type: item.dataset.type,\r\n            text: item.textContent.trim(),\r\n            slot_value: item.dataset.slotValue\r\n          })\r\n        } else {\r\n          return ({ text: item.textContent.trim() }\r\n          )\r\n        }\r\n      }).filter(item => item.text.length);\r\n\r\n      let raw = model.map(item => item.text).join(' ');\r\n      let utterances = [...props.utterances];\r\n      let newUtterance = { raw: raw, model: model }\r\n\r\n      if (!_.isEqual(newUtterance, props.utterance)) {\r\n        utterances[props.index] = newUtterance;\r\n        props.setUtterances(utterances)\r\n      }\r\n    }\r\n  }, [whitelist]);\r\n\r\n  const handleValidationResult = ( result) => {\r\n    if (validationResult.valid !== result.valid || validationResult.message !== result.message) { \r\n        setValidationResult( result);\r\n    }\r\n    return validationResult.valid;\r\n  }\r\n\r\n  const validateInput = () => {\r\n    \r\n    if ( !( whitelist && whitelist.nodes)) {\r\n        // No utterances at all\r\n        return handleValidationResult( {\r\n            valid : false,\r\n            message : ''\r\n        });\r\n    }\r\n    \r\n    let nodes = whitelist.nodes;\r\n    let textNodes = nodes.filter(item => !item.tagName);\r\n    \r\n    if ( textNodes.length === 0) {\r\n        // No free text to validate\r\n        return handleValidationResult( OK);\r\n    } \r\n    \r\n    let nodesMappedToString = nodes.map(item => {\r\n    if (item.dataset && item.dataset.type) return `{${item.dataset.type}}`\r\n        return item.textContent.trim()\r\n    }).join(' ');\r\n    \r\n    let intentsWithDuplicateUtterances = props.allUtterancesInIntents.filter(item => item.string === nodesMappedToString);\r\n      \r\n    if ( intentsWithDuplicateUtterances.length > 1 && nodes.length > 0) {\r\n        return handleValidationResult( {\r\n            valid : false,\r\n            message : `Utterance must be unique across intents. This utterance appears in <strong>${intentsWithDuplicateUtterances[0].intent}</strong>.` \r\n        });\r\n    }\r\n    \r\n    if ( props.validator) {\r\n        let str = textNodes.map(item => item.textContent.trim()).join(' ');\r\n        let result = props.validator( str);\r\n        return handleValidationResult( result);\r\n    }\r\n\r\n    return handleValidationResult( OK);\r\n  }\r\n\r\n  const updateRaw = () => {\r\n    setRaw(input.current.innerHTML);\r\n  }\r\n\r\n  if (props) {\r\n    return (\r\n      <React.Fragment>\r\n        <div ref={wrapper} data-field-valid={`${valid}`} className={`field field--intent ${active ? 'field--active' : ''}`}>\r\n          <div\r\n            className='field__main'\r\n          >\r\n            <div ref={inputWrapper} className='field__input' data-valid={validateInput() ? 'true' : 'false'}>\r\n              <UtteranceInput index={props.index} input={input} active={active} setActive={props.setActive} utterances={props.utterances} raw={raw} setRaw={setRaw} entities={props.entities} selection={selection} setSelection={setSelection} slotValuePairs={props.slotValuePairs} handleNew={props.handleNew} valid={valid} />\r\n              <div className=\"field__actions\">\r\n                {props.index !== 0 && props.utterances.length > 1 &&\r\n                  <button type=\"button\" onClick={() => {\r\n                    props.removeFromUtterances(props.utterance);\r\n                    document.querySelectorAll('.taggable-text__input')[0].focus();\r\n                  }}>\r\n                    <IconTrash />\r\n                  </button>}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          {!props.new && whitelist && whitelist.tags.length > 0 &&\r\n            <ul className=\"model-list\" style={{ display: active ? 'block' : 'none' }}>\r\n              <header className=\"model-list__header\">\r\n                <strong>Parameter name</strong>\r\n                <strong>Entity</strong>\r\n                <strong>Resolved value</strong>\r\n              </header>\r\n              {whitelist.tags && whitelist.tags.map((item, index) => {\r\n                if (item.target && item.type) return (\r\n                  <li className=\"model-list__item\" key={index}>\r\n                    <UtteranceSlotValue key={index} index={index} target={item.target} slotValue={item.slot_value} whitelist={whitelist} updateRaw={updateRaw} />\r\n                    <div>\r\n                      <button className=\"mark\" type=\"button\" style={{ background: item.color }} onClick={() => setSelection(item.target) }>\r\n                        {item.type && item.type[0] === '@' ? '' : '@'}{item.type}\r\n                      </button>\r\n                    </div>\r\n                    <div>{item.text}</div>\r\n                  </li>\r\n                )\r\n              })}\r\n            </ul>\r\n          }\r\n          {validationResult.message.length > 0 && <p className={validationResult.valid ? 'field__warning':'field__error'}>{reactHtmlParser(validationResult.message)}</p>}\r\n        </div>\r\n      </React.Fragment>\r\n    )\r\n  } else {\r\n    return null\r\n  }\r\n})","import React, { useState, useEffect, useRef } from 'react'\r\nimport { Utterance } from './utterance/Utterance.jsx'\r\n\r\nconst IntentUtterances = (props) => {\r\n  const [active, setActive] = useState(null);\r\n  const removeFromUtterances = (object) => {\r\n    let arr = props.utterances.filter(item => item !== object);\r\n    props.setUtterances(arr);\r\n    setActive(null);\r\n    props.setStateChange(!props.stateChange)\r\n  }\r\n\r\n\r\n  const handleNew = (valid) => {\r\n    if (valid) {\r\n      if (props.utterances[0].model.length > 0) {\r\n\r\n        let newUtteranceField = { raw: '', model: [] };\r\n        let arr = [newUtteranceField, ...props.utterances];\r\n\r\n        props.setUtterances(arr);\r\n        props.setStateChange(!props.stateChange);\r\n      }\r\n\r\n      setTimeout(() => {\r\n        let input = document.querySelectorAll('.taggable-text__input')[0];\r\n        input && input.focus();\r\n      }, 100);\r\n    }\r\n  }\r\n\r\n  if (props.utterances) {\r\n    return (\r\n      <ul>\r\n        {props.utterances.map((item, index) => {\r\n          return (\r\n            <li key={index} style={{ display: item.raw.toLowerCase().includes(props.searchPhrase) ? 'block' : 'none' }}>\r\n              <Utterance\r\n                key={index}\r\n                allUtterancesInIntents={props.allUtterancesInIntents}\r\n                utterances={props.utterances}\r\n                validator={props.validator}\r\n                utterance={item}\r\n                index={index}\r\n                active={active}\r\n                setActive={setActive}\r\n                entities={props.entities}\r\n                removeFromUtterances={removeFromUtterances}\r\n                setUtterances={props.setUtterances}\r\n                stateChange={props.stateChange}\r\n                setStateChange={props.setStateChange}\r\n                slotValuePairs={props.slotValuePairs}\r\n                handleNew={handleNew} />\r\n            </li>\r\n          )\r\n        })}\r\n      </ul>\r\n    )\r\n  } else {\r\n    return null\r\n  }\r\n}\r\n\r\nexport default React.memo(IntentUtterances);\r\n","import React, { useState, useEffect } from 'react';\r\nimport IntentUtterances from './IntentUtterances.jsx';\r\nimport _, { property } from 'lodash';\r\nimport { simpleValidateInput, validateInput } from '../../helpers/validations.jsx';\r\n\r\nimport { preventSubmit } from '../../helpers/common_constants.jsx';\r\nimport { iconSearch } from '../../helpers/image_paths.jsx';\r\n\r\nfunction IntentDetails(props) {\r\n\r\n  const [intent] = useState(props.intent);\r\n  const entities = props.entities;\r\n  const systemEntities = props.systemEntities;\r\n  const [stateChange, setStateChange] = useState(false);\r\n  const [name, setName] = useState('');\r\n  const [utterances, setUtterances] = useState([]);\r\n  const [slotValuePairs, setSlotValuePairs] = useState([]);\r\n  const [searchPhrase, setSearchPhrase] = useState('');\r\n\r\n  // check if data is passed in props\r\n  useEffect(() => {\r\n    if (intent) {\r\n      setName(intent.name);\r\n      if (intent.utterances.length) {\r\n        /* add new field if only one utterance is present */\r\n        setUtterances([{ raw: '', model: [] }, ...intent.utterances.filter(item => item.model.length > 0)]);\r\n      } else {\r\n        setUtterances([{ raw: '', model: [] }])\r\n      }\r\n    }\r\n  }, [intent]);\r\n\r\n  const setInitialSlotValuePairs = () => {\r\n    let arr = utterances.map(item => item.model).flat().filter(item => item.slot_value).map(item => ({\r\n      type: item.type,\r\n      slot_value: item.slot_value\r\n    }));\r\n\r\n    setSlotValuePairs(arr);\r\n  }\r\n\r\n  useEffect(() => {\r\n    setInitialSlotValuePairs();\r\n  }, [utterances]);\r\n\r\n\r\n  useEffect(() => {\r\n    if (name && utterances) {\r\n      // TODO: using a timeout is really hacky -> do better\r\n      setTimeout(() => {\r\n        const valid = document.querySelectorAll('[data-field-valid=\"false\"]').length < 1;\r\n        let updatedIntent = {\r\n          ...intent,\r\n          name: name,\r\n          utterances: utterances.filter(item => item.model.length),\r\n          type: intent.type || 'custom'\r\n        }\r\n\r\n        props.onUpdate(updatedIntent, valid);\r\n      }, 10)\r\n    }\r\n  }, [name, utterances]);\r\n\r\n  const handleSearch = (term) => {\r\n    setSearchPhrase(term);\r\n  }\r\n\r\n  const handleNameChange = (e) => {\r\n    let message =\r\n      'Intent names shall begin with alphabetic characters from a to Z. The intent name may contain 1 underscore per word. Intent names shall not contain any numbers at all.';\r\n    let isTextValid = simpleValidateInput(e.target.value, '^[A-Za-z](_?[A-Za-z])*_?$');\r\n    let doesSameIntentNameExist = props.intents.filter(item => (item.name === e.target.value) && item !== intent).length > 0;\r\n\r\n    if (!isTextValid) {\r\n      e.target.setCustomValidity(message);\r\n    } else if (doesSameIntentNameExist) {\r\n      e.target.setCustomValidity('Intent name must be unique')\r\n    } else {\r\n      e.target.setCustomValidity('');\r\n    }\r\n\r\n    e.target.reportValidity();\r\n    setName(e.target.value);\r\n  }\r\n\r\n  const mapUtterancesAsString = (model) => {\r\n    return model.map(item => {\r\n      if (item.type) return `{${item.type}}`\r\n      return item.text\r\n    }).join(' ');\r\n  }\r\n\r\n  if (intent && props.intents) { \r\n\r\n    const outsideIntentUtterances = !intent.parent_intent ? props.intents\r\n      .filter(obj => obj.name !== intent.name && !obj.parent_intent)\r\n      .map(intent => intent.utterances.map(utterance => ({ intent: intent.name, string: mapUtterancesAsString(utterance.model) })))\r\n      .flat()\r\n      .filter(utterance => utterance.string !== \"\") : [];\r\n    \r\n    const currentIntentUtterances = utterances.map(utterance => ({ intent: intent.name, string: mapUtterancesAsString(utterance.model) }))\r\n      .filter(utterance => utterance.string !== \"\");\r\n    \r\n    const allUtterancesInIntents = [...outsideIntentUtterances, ...currentIntentUtterances];\r\n\r\n    return (\r\n      <div className=\"convo-details\">\r\n        <section className=\"layout--editor-content\">\r\n          <div>\r\n            {/* Entity name value */}\r\n            <hr />\r\n            <div className=\"margin--30--large\">\r\n              <h3 className=\"margin--10--large\">Intent name</h3>\r\n              <input\r\n                type=\"text\"\r\n                defaultValue={name ? name : ''}\r\n                placeholder=\"Intent name\"\r\n                className=\"input input--item-name\"\r\n                onKeyDown={(e) => preventSubmit(e)}\r\n                onChange={e => handleNameChange(e)}\r\n              />\r\n            </div>\r\n            {/* Entity words */}\r\n            <div className=\"margin--50--large\">\r\n              <div className=\"search-wrapper\">\r\n                <h3>Utterances</h3>\r\n                <input\r\n                  style={{ background: `url(${iconSearch}) no-repeat 12px center`, backgroundSize: '18px', paddingLeft: '42px' }}\r\n                  className=\"input input--search\"\r\n                  type=\"text\" placeholder=\"Search utterances\"\r\n                  onChange={(e) => {\r\n                    handleSearch(e.target.value);\r\n                  }}\r\n                  onKeyDown={(e) => preventSubmit(e)}\r\n                />\r\n              </div>\r\n              <div className=\"margin--24--large\">\r\n                <IntentUtterances\r\n                  validator={props.validator}\r\n                  intents={props.intents}\r\n                  allUtterancesInIntents={allUtterancesInIntents}\r\n                  utterances={utterances}\r\n                  setUtterances={setUtterances}\r\n                  entities={[entities, ...systemEntities]}\r\n                  stateChange={stateChange}\r\n                  setStateChange={setStateChange}\r\n                  searchPhrase={searchPhrase}\r\n                  slotValuePairs={slotValuePairs}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </section>\r\n      </div>\r\n    );\r\n  } else {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport default IntentDetails;\r\n","import React from 'react'\r\nimport EntityDetails from './components/EntityComponent/EntityDetails'\r\nimport IntentDetails from './components/IntentComponent/IntentDetails'\r\nimport './styles.scss'\r\n\r\nexport const IntentEditor = (props) => {\r\n  return <IntentDetails intents={props.intents} intent={props.intent} entities={props.entities} \r\n        systemEntities={props.systemEntities} onUpdate={props.onUpdate} validator={props.validator} />\r\n}\r\n\r\nexport const EntityEditor = (props) => {\r\n  return <EntityDetails entity={props.entity} onUpdate={props.onUpdate} />\r\n}"],"names":["stringToColor","value","toLowerCase","getHashCode","intToHSL","String","prototype","hash","length","i","charCodeAt","Number","shortened","getCaretCharacterOffsetWithin","element","caretOffset","doc","ownerDocument","document","win","defaultView","parentWindow","sel","getSelection","rangeCount","range","getRangeAt","preCaretRange","cloneRange","selectNodeContents","setEnd","endContainer","endOffset","toString","selection","type","textRange","createRange","preCaretTextRange","body","createTextRange","moveToElementText","setEndPoint","text","preventSubmit","event","keyCode","preventDefault","setCaretPosition","el","pos","childNodes","node","nodeType","window","setStart","collapse","removeAllRanges","addRange","iconSearch","iconTrash","IconTrash","React","EntityValue","props","useState","item","setValue","synonyms","setSynonyms","newSynonym","setNewSynonym","remove","setRemove","synonymInput","useRef","active","activeValue","index","useEffect","handleUpdate","values","handleNewSynonym","target","current","removeSynonym","arr","indexOf","splice","makeSynonyms","items","isActive","map","handleRemove","e","stopPropagation","setTimeout","removeValue","setActiveValue","marginLeft","EntityValues","setValues","validateInput","elem","term","regex","message","reg","RegExp","test","setCustomValidity","reportValidity","simpleValidateInput","EntityDetails","entity","setEntity","name","setName","newValue","setNewValue","valid","setValid","valueInput","onUpdate","addNewValue","val","filteredArr","filter","validate","UtteranceSlotValue","memo","input","validateSlotValue","regTest","dataset","slotValue","updateRaw","Dropdown","setTerm","entities","entitiesNames","setEntitiesNames","modalRef","useOnclickOutside","setSelection","filterEntities","str","flat","dropdownStyles","position","top","transition","visibility","dropdownState","opacity","left","display","includes","toLocaleLowerCase","trim","tagSelection","UtteranceInput","setDropdownState","keyPress","setKeyPress","cursorPosition","createNode","slot_value","mark","createElement","newTextNode","createTextNode","appendChild","textContent","setAttribute","style","background","tagName","getSlotValue","existingSlotValue","slotValuePairs","find","split","extractContents","insertNode","parentElement","replaceWith","innerHTML","forEach","slice","outline","lastChar","newRaw","setRaw","handleSelection","rangy","expand","s","oRange","oRect","getBoundingClientRect","x","sanitize","string","sanitizeHtml","allowedTags","allowedAttributes","handleNew","raw","setActive","Utterance","OK","validationResult","setValidationResult","wrapper","inputWrapper","whitelist","tags","Array","from","color","nodes","utterance","model","join","stateChange","isValid","querySelectorAll","utterances","newUtterance","_","isEqual","setUtterances","handleValidationResult","result","textNodes","nodesMappedToString","intentsWithDuplicateUtterances","allUtterancesInIntents","intent","validator","removeFromUtterances","focus","reactHtmlParser","IntentUtterances","object","setStateChange","newUtteranceField","searchPhrase","IntentDetails","systemEntities","setSlotValuePairs","setSearchPhrase","setInitialSlotValuePairs","updatedIntent","handleSearch","handleNameChange","isTextValid","doesSameIntentNameExist","intents","mapUtterancesAsString","outsideIntentUtterances","parent_intent","obj","currentIntentUtterances","backgroundSize","paddingLeft","IntentEditor","EntityEditor"],"mappings":"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"}