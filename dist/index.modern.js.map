{"version":3,"file":"index.modern.js","sources":["../src/assets/icon_trash.jsx","../src/components/EntityComponent/EntityValue.jsx","../src/components/EntityComponent/EntityValues.jsx","../src/helpers/validations.jsx","../src/components/EntityComponent/EntityDetails.jsx","../src/helpers/common_constants.jsx","../src/components/IntentComponent/utterance/Utterance.jsx","../src/components/IntentComponent/IntentUtterances.jsx","../src/components/IntentComponent/IntentDetails.jsx","../src/index.js"],"sourcesContent":["import React from 'react';\n\nfunction IconTrash() {\n\treturn (\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\">\n\t\t\t<g fill=\"none\" fill-rule=\"evenodd\" stroke=\"#1A1A1A\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n\t\t\t\t<path d=\"M2.4 6.5v7c0 1.105.835 2 1.867 2h7.466c1.032 0 1.867-.895 1.867-2v-7M1.467 3.5h13.066M6.133 3.5v-3h3.734v3M8 7.5v5M10.8 7.5v5M5.2 7.5v5\" />\n\t\t\t</g>\n\t\t</svg>\n\t);\n}\n\nexport { IconTrash };\n","import React, { useState, useRef, useEffect } from 'react';\nimport { IconTrash } from '../../assets/icon_trash.jsx';\n\nconst EntityValue = (props) => {\n\tconst [ value, setValue ] = useState(props.item.value);\n\tconst [ synonyms, setSynonyms ] = useState(props.item.synonyms);\n\tconst [ newSynonym, setNewSynonym ] = useState('');\n\tconst [ remove, setRemove ] = useState(false);\n\tconst synonymInput = useRef(null);\n\n\tuseEffect(\n\t\t() => {\n\t\t\tprops.handleUpdate([ ...props.values ], props.index, {\n\t\t\t\tvalue: value,\n\t\t\t\tsynonyms: synonyms\n\t\t\t});\n\t\t},\n\t\t[ value, synonyms ]\n\t);\n\n\tuseEffect(\n\t\t() => {\n\t\t\tif (newSynonym) {\n\t\t\t\tif (synonyms) {\n\t\t\t\t\tsetSynonyms([ ...synonyms, newSynonym ]);\n\t\t\t\t} else {\n\t\t\t\t\tsetSynonyms(newSynonym);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t\t},\n\t\t[ newSynonym ]\n\t);\n\n\tconst handleNewSynonym = (target) => {\n\t\tif (target.current.value.length > 0) {\n\t\t\tsetNewSynonym(target.current.value);\n\t\t\ttarget.current.value = '';\n\t\t} else {\n\t\t\tsetNewSynonym('');\n\t\t}\n\t};\n\n\t// synonyms\n\tconst removeSynonym = (value) => {\n\t\tlet arr = [ ...synonyms ];\n\t\tlet index = arr.indexOf(value);\n\n\t\tif (index !== -1) {\n\t\t\tarr.splice(index, 1);\n\t\t\tsetSynonyms(arr);\n\t\t}\n\t};\n\n\tconst makeSynonyms = (items, active) => {\n\t\tif (items) {\n\t\t\treturn (\n\t\t\t\titems &&\n\t\t\t\titems.map((item, i) => {\n\t\t\t\t\tif (item && !active) {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<div className=\"synonym\" key={i}>\n\t\t\t\t\t\t\t\t{item}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<div key={i} className=\"synonym\">\n\t\t\t\t\t\t\t\t{item}\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\tclassName=\"synonym__remove\"\n\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\tremoveSynonym(item);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t&#10005;\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t};\n\n\tconst handleRemove = (e) => {\n\t\te.stopPropagation();\n\t\tsetRemove(true);\n\t\tsetTimeout(() => {\n\t\t\tprops.removeValue(props.index);\n\t\t\tsetRemove(false);\n\t\t}, 220);\n\t};\n\n\tif (props.activeValue !== props.index) {\n\t\treturn (\n\t\t\t<li\n\t\t\t\tclassName={`item item--entity ${remove ? 'item--remove' : ''}`}\n\t\t\t\tonClick={() => {\n\t\t\t\t\tprops.setActiveValue(props.index);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div className=\"item__inner\">\n\t\t\t\t\t<div className=\"grid\">\n\t\t\t\t\t\t<div className=\"cell cell--3--small\">\n\t\t\t\t\t\t\t<div className=\"item__value item__value--primary\">{value}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"cell cell--9--small\">\n\t\t\t\t\t\t\t<div className=\"item__values\">{makeSynonyms(synonyms, false)}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"item__buttons\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName=\"btn--remove btn--remove--main\"\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\tonClick={(e) => {\n\t\t\t\t\t\t\thandleRemove(e);\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<IconTrash />\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</li>\n\t\t);\n\t} else {\n\t\treturn (\n\t\t\t<li className={`item item--entity item--active ${remove ? 'item--remove' : ''}`}>\n\t\t\t\t<div className=\"item__inner\">\n\t\t\t\t\t<div className=\"grid\">\n\t\t\t\t\t\t<div className=\"cell cell--3--small\">\n\t\t\t\t\t\t\t<div className=\"item__value item__value--primary\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdata-input=\"true\"\n\t\t\t\t\t\t\t\t\tclassName=\"editor-input\"\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tdefaultValue={value}\n\t\t\t\t\t\t\t\t\tplaceholder=\"Enter value\"\n\t\t\t\t\t\t\t\t\tonChange={(e) => {\n\t\t\t\t\t\t\t\t\t\tsetValue(e.target.value);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"cell cell--9--small\">\n\t\t\t\t\t\t\t<div className=\"item__values\">\n\t\t\t\t\t\t\t\t{makeSynonyms(synonyms, true)}\n\t\t\t\t\t\t\t\t<form\n\t\t\t\t\t\t\t\t\tonSubmit={(e) => {\n\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\thandleNewSynonym(synonymInput);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tclassName=\"editor-input\"\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\tstyle={{ marginLeft: '0.625rem' }}\n\t\t\t\t\t\t\t\t\t\tref={synonymInput}\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"Enter synonym\"\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => {}}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<input className=\"editor-input\" type=\"submit\" hidden={true} />\n\t\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"item__buttons\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName=\"btn--remove btn--remove--main\"\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\tonClick={(e) => {\n\t\t\t\t\t\t\thandleRemove(e);\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<IconTrash />\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</li>\n\t\t);\n\t}\n};\n\nexport default EntityValue;\n","import React, { useState, useEffect } from 'react';\nimport EntityValue from './EntityValue.jsx';\n\nfunction EntityValues(props) {\n\tconst [ activeValue, setActiveValue ] = useState(null);\n\n\tfunction handleUpdate(arr, index, item) {\n\t\tarr[index] = {\n\t\t\tvalue: item.value,\n\t\t\tsynonyms: item.synonyms\n\t\t};\n\n\t\tprops.setValues(arr);\n\t}\n\n\tconst makeItems = (items) => {\n\t\tif (items) {\n\t\t\treturn items.map((item, index) => {\n\t\t\t\treturn (\n\t\t\t\t\t<React.Fragment key={index}>\n\t\t\t\t\t\t<EntityValue\n\t\t\t\t\t\t\tindex={index}\n\t\t\t\t\t\t\titem={item}\n\t\t\t\t\t\t\tvalues={props.values}\n\t\t\t\t\t\t\tremoveValue={props.removeValue}\n\t\t\t\t\t\t\thandleUpdate={handleUpdate}\n\t\t\t\t\t\t\tactiveValue={activeValue}\n\t\t\t\t\t\t\tsetActiveValue={setActiveValue}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</React.Fragment>\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t};\n\n\tif (props.values) {\n\t\treturn <div>{makeItems(props.values)}</div>;\n\t} else {\n\t\treturn null\n\t}\n}\n\nexport default EntityValues;\n","export const validateInput = (elem, term, regex, message) => {\n  let reg = new RegExp(regex);\n  if (reg.test(term)) {\n    elem.setCustomValidity('');\n  } else {\n    elem.setCustomValidity(message);\n  }\n  elem.reportValidity();\n\n  return reg.test(term);\n};\n","import React, { useState, useEffect } from 'react';\nimport EntityValues from './EntityValues.jsx';\nimport _ from 'lodash';\nimport { useRef } from 'react';\nimport { validateInput } from '../../helpers/validations.jsx';\n\nfunction EntityDetails(props) {\n\tconst [ entity, setEntity ] = useState(null);\n\tconst [ name, setName ] = useState(null);\n\tconst [ values, setValues ] = useState(null);\n\tconst [ newValue, setNewValue ] = useState(null);\n\tconst [valid, setValid] = useState(true);\n\tconst valueInput = useRef(null);\n\n\tuseEffect(\n\t\t() => {\n\t\t\tif (!entity) {\n\t\t\t\tsetEntity(props.entity);\n\t\t\t}\n\t\t},\n\t\t[ props.entity ]\n\t);\n\n\tuseEffect(\n\t\t() => {\n\t\t\tsetName(props.entity.name);\n\t\t\tsetValues(props.entity.values);\n\t\t},\n\t\t[ entity ]\n\t);\n\n\tuseEffect(\n\t\t() => {\n\t\t\tif (name && values) {\n\t\t\t\tprops.onUpdate({\n\t\t\t\t\tname: name,\n\t\t\t\t\tvalues: values\n\t\t\t\t}, valid);\n\t\t\t}\n\t\t},\n\t\t[ name, values ]\n\t);\n\n\t// add new value to value array\n\tconst addNewValue = () => {\n\t\tlet val = {\n\t\t\tvalue: newValue,\n\t\t\tsynonyms: []\n\t\t};\n\n\t\tlet arr = [...values, val];\n\t\tsetValues(arr);\n\t};\n\n\tconst removeValue = (index) => {\n\t\tlet arr = [ ...values ];\n\t\tif (index !== -1) {\n\t\t\tarr.splice(index, 1);\n\t\t\tsetValues(arr);\n\t\t}\n\t};\n\n\tif (values) {\n\t\treturn (\n\t\t\t<div className=\"convo-details\">\n\t\t\t\t<section className=\"layout--editor-content\">\n\t\t\t\t\t<section className=\"entities-editor\">\n\t\t\t\t\t\t{/* Entity name value */}\n\t\t\t\t\t\t<div className=\"margin--30--large\">\n\t\t\t\t\t\t\t<h3 className=\"margin--10--large\">Entity name</h3>\n\t\t\t\t\t\t\t<form\n\t\t\t\t\t\t\t\tonSubmit={(e) => {\n\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tdefaultValue={name ? name : ''}\n\t\t\t\t\t\t\t\t\tplaceholder=\"Entity name\"\n\t\t\t\t\t\t\t\t\tclassName=\"editor-input input--item-name\"\n\t\t\t\t\t\t\t\t\tonChange={(e) => {\n\t\t\t\t\t\t\t\t\t\tlet message = 'Entity names shall begin with alphabetic characters from a to Z. The entity name may contain multiple underscores per word. Entity names shall not contain any numbers at all or soecial characters other than undersocres.'\n\t\t\t\t\t\t\t\t\t\tlet validate = validateInput(e.target, e.target.value, '^[A-Za-z](_*[A-Za-z])*_*$', message);\n\t\t\t\t\t\t\t\t\t\tsetValid(validate);\n\t\t\t\t\t\t\t\t\t\tsetName(e.target.value);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/* Entity words */}\n\t\t\t\t\t\t<div className=\"margin--50--large\">\n\t\t\t\t\t\t\t<h3 className=\"font--18--large margin--10--large\">Values</h3>\n\t\t\t\t\t\t\t<div className=\"margin--24--large\">\n\t\t\t\t\t\t\t\t<EntityValues values={values} setValues={setValues} removeValue={removeValue} />\n\t\t\t\t\t\t\t\t<form onSubmit={(e) => {\n\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\tif (newValue) {\n\t\t\t\t\t\t\t\t\t\taddNewValue();\n\t\t\t\t\t\t\t\t\t\tsetNewValue(null);\n\t\t\t\t\t\t\t\t\t\tvalueInput.current.value = '';\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}}>\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\tclassName=\"editor-input input--add-field\"\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"Enter reference value\"\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => setNewValue(e.target.value)}\n\t\t\t\t\t\t\t\t\t\tref={valueInput}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</section>\n\t\t\t\t</section>\n\t\t\t</div>\n\t\t);\n\t} else {\n\t\treturn null;\n\t}\n}\n\nexport default EntityDetails;\n","export const getRandomColor = () => {\n\tvar letters = \"0123456789ABCDEF\";\n\tvar color = \"#\";\n\n\tfor (var i = 0; i < 6; i++) {\n\t\tcolor += letters[Math.floor(Math.random() * 16)];\n\t}\n\treturn color;\n};\n\nexport const stringToColor = (value) => {\n\treturn value.getHashCode().intToHSL();\n}\n\nString.prototype.getHashCode = function () {\n\tvar hash = 0;\n\tif (this.length == 0) return hash;\n\tfor (var i = 0; i < this.length; i++) {\n\t\thash = this.charCodeAt(i) + ((hash << 5) - hash);\n\t\thash = hash & hash; // Convert to 32bit integer\n\t}\n\treturn hash;\n};\nNumber.prototype.intToHSL = function () {\n\tvar shortened = this % 360;\n\treturn \"hsl(\" + shortened + \",100%,70%)\";\n};\n\n\nexport const getCaretCharacterOffsetWithin = (element) => {\n\tvar caretOffset = 0;\n\tvar doc = element.ownerDocument || element.document;\n\tvar win = doc.defaultView || doc.parentWindow;\n\tvar sel;\n\tif (typeof win.getSelection != \"undefined\") {\n\t\tsel = win.getSelection();\n\t\tif (sel.rangeCount > 0) {\n\t\t\tvar range = win.getSelection().getRangeAt(0);\n\t\t\tvar preCaretRange = range.cloneRange();\n\t\t\tpreCaretRange.selectNodeContents(element);\n\t\t\tpreCaretRange.setEnd(range.endContainer, range.endOffset);\n\t\t\tcaretOffset = preCaretRange.toString().length;\n\t\t}\n\t} else if ((sel = doc.selection) && sel.type != \"Control\") {\n\t\tvar textRange = sel.createRange();\n\t\tvar preCaretTextRange = doc.body.createTextRange();\n\t\tpreCaretTextRange.moveToElementText(element);\n\t\tpreCaretTextRange.setEndPoint(\"EndToEnd\", textRange);\n\t\tcaretOffset = preCaretTextRange.text.length;\n\t}\n\treturn caretOffset;\n}\n\nexport const getColor = (index) => {\n\tlet arr = [\n\t\t\"#56ebd3\",\n\t\t\"#fbacf6\",\n\t\t\"#9ee786\",\n\t\t\"#e4b5ff\",\n\t\t\"#c2e979\",\n\t\t\"#20d8fd\",\n\t\t\"#e8d25c\",\n\t\t\"#42edec\",\n\t\t\"#f3c46f\",\n\t\t\"#5cefba\",\n\t\t\"#e8de7a\",\n\t\t\"#7ee8c0\",\n\t\t\"#e8d98c\",\n\t\t\"#88e99a\",\n\t\t\"#cfdd73\",\n\t\t\"#8be8ad\",\n\t\t\"#dff799\",\n\t\t\"#b5eaa1\",\n\t\t\"#c2d681\",\n\t\t\"#b5e287\",\n\t];\n\n\treturn arr[index % arr.length]\n};\n","import React, { useRef, useState, useEffect, memo } from 'react'\nimport Tags from '@yaireo/tagify/dist/react.tagify' // React-wrapper file\nimport '@yaireo/tagify/src/tagify.scss'\nimport rangy from 'rangy'\nimport _, { debounce } from 'lodash'\nimport ContentEditable from 'react-contenteditable'\nimport { getCaretCharacterOffsetWithin, stringToColor } from '../../../helpers/common_constants'\n\nexport default function Utterance(props) {\n\tconst [raw, setRaw] = useState('');\n\tconst [state, setState] = useState(false);\n\n\tconst [modalState, setModalState] = useState({\n\t\tposition: 0,\n\t\tactive: false\n\t});\n\n\tconst [inputText, setInputText] = useState(null)\n\n\tconst [model, setModel] = useState(props.data.model)\n\tconst [selection, setSelection] = useState(null)\n\tconst [whitelist, setWhitelist] = useState(\n\t\tprops.data.model\n\t\t\t.filter((item) => item.type)\n\t\t\t.map((item) => ({\n\t\t\t\ttext: item.text,\n\t\t\t\ttype: item.type,\n\t\t\t\tslot_value: item.slot_value\n\t\t\t}))\n\t)\n\n\tconst input = useRef('');\n\tconst modalRef = useRef('');\n\tconst tagsRef = useRef('');\n\tconst text = useRef('');\n\tconst targetText = useRef('')\n\n\tconst isArrayEqual = function (x, y) {\n\t\treturn _(x).xorWith(y, _.isEqual).isEmpty()\n\t}\n\n\tuseEffect(() => {\n\t\ttext.current = props.data.raw;\n\t}, [])\n\n\tconst handleChange = evt => {\n\t\ttext.current = evt.target.value;\n\t\ttagsRef.current.innerHTML = parseText(evt.target.value);\n\t};\n\n\tfunction parseText(string) {\n\t\tif (string) {\n\t\t\tlet str = string.replace(/\\s+/g, ' ').trim()\n\t\t\tlet regex = new RegExp(\n\t\t\t\twhitelist\n\t\t\t\t\t.map((item) => item.text.replace(/\\s+/g, ' ').trim())\n\t\t\t\t\t.join('|'),\n\t\t\t\t'gi'\n\t\t\t)\n\n\t\t\tstr = str.replace(regex, function (matched) {\n\t\t\t\treturn `<mark style=\"background:${stringToColor(matched)}\">${matched}</mark>`\n\t\t\t})\n\n\t\t\treturn str\n\t\t}\n\t}\n\n\tconst tagSelection = () => {\n\t\tsetTimeout(() => {\n\t\t\tlet list = [...whitelist]\n\n\t\t\t//\t\t\t\tconsole.log(list, list.filter(item => selection.includes(item)))\n\n\t\t\tlist.map((item, index) => {\n\t\t\t\tif (selection.includes(item.text) || item.text.includes(selection)) {\n\t\t\t\t\tlist.splice(index, 1)\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tlist = [...list, { text: selection, type: '', slot_value: '' }]\n\n\t\t\tsetWhitelist(list);\n\t\t\tsetSelection(null);\n\t\t}, 220)\n\t}\n\n\tconst handleSelection = () => {\n\t\tvar sel\n\n\t\t// Check for existence of window.getSelection() and that it has a\n\t\t// modify() method. IE 9 has both selection APIs but no modify() method.\n\t\tif (window.getSelection && (sel = window.getSelection()).modify) {\n\t\t\tsel = window.getSelection()\n\t\t\tif (!sel.isCollapsed) {\n\t\t\t\t// Detect if selection is backwards\n\t\t\t\tvar range = document.createRange()\n\t\t\t\trange.setStart(sel.anchorNode, sel.anchorOffset)\n\t\t\t\trange.setEnd(sel.focusNode, sel.focusOffset)\n\t\t\t\tvar backwards = range.collapsed\n\t\t\t\trange.detach()\n\n\t\t\t\t// modify() works on the focus of the selection\n\t\t\t\tvar endNode = sel.focusNode,\n\t\t\t\t\tendOffset = sel.focusOffset\n\t\t\t\tsel.collapse(sel.anchorNode, sel.anchorOffset)\n\n\t\t\t\tvar direction = []\n\t\t\t\tif (backwards) {\n\t\t\t\t\tdirection = ['backward', 'forward']\n\t\t\t\t} else {\n\t\t\t\t\tdirection = ['forward', 'backward']\n\t\t\t\t}\n\n\t\t\t\tsel.modify('move', direction[0], 'character')\n\t\t\t\tsel.modify('move', direction[1], 'word')\n\t\t\t\tsel.extend(endNode, endOffset)\n\t\t\t\tsel.modify('extend', direction[1], 'character')\n\t\t\t\tsel.modify('extend', direction[0], 'word')\n\t\t\t}\n\t\t} else if ((sel = document.selection) && sel.type != 'Control') {\n\t\t\tvar textRange = sel.createRange()\n\t\t\tif (textRange.text) {\n\t\t\t\ttextRange.expand('word')\n\t\t\t\t// Move the end back to not include the word's trailing space(s),\n\t\t\t\t// if necessary\n\t\t\t\twhile (/\\s$/.test(textRange.text)) {\n\t\t\t\t\ttextRange.moveEnd('character', -1)\n\t\t\t\t}\n\t\t\t\ttextRange.select()\n\t\t\t}\n\t\t}\n\n\t\tif (sel.toString().length) {\n\t\t\tsetSelection(sel.toString())\n\t\t} else {\n\t\t\tsetSelection(null);\n\t\t}\n\t}\n\n\t// generate a random color (in HSL format, which I like to use)\n\tfunction getRandomColor() {\n\t\tfunction rand(min, max) {\n\t\t\treturn min + Math.random() * (max - min)\n\t\t}\n\n\t\tvar h = rand(1, 360) | 0,\n\t\t\ts = rand(40, 70) | 0,\n\t\t\tl = rand(65, 72) | 0\n\n\t\treturn 'hsl(' + h + ',' + s + '%,' + l + '%)'\n\t}\n\n\tuseEffect(() => {\n\t\tlet s = window.getSelection();\n\t\tlet oRange = s.getRangeAt(0); //get the text range\n\t\tlet oRect = oRange.getBoundingClientRect();\n\n\t\tsetModalState({\n\t\t\tposition: oRect.x,\n\t\t\tactive: selection !== null\n\t\t})\n\n\n\t}, [selection]);\n\n\tif (props.data) {\n\n\t\tlet modalStyles = {\n\t\t\tposition: 'absolute',\n\t\t\ttop: '100%',\n\t\t\ttransition: 'all 220ms ease-in-out',\n\t\t\tvisibility: modalState.active ? 'visible' : 'hidden',\n\t\t\topacity: modalState.active ? '1' : '0',\n\t\t\tleft: modalState.position\n\t\t}\n\n\t\treturn (\n\t\t\t<div class={`field field--intent ${props.active === props.index ? 'field--active' : ''}`} onClick={() => {\n\t\t\t\tprops.setActive(props.index)\n\t\t\t}}>\n\t\t\t\t<div\n\t\t\t\t\tclassName='field__main'\n\t\t\t\t\tid='input'\n\t\t\t\t>\n\t\t\t\t\t<div className='field__input'>\n\t\t\t\t\t\t<div class='taggable-text'>\n\t\t\t\t\t\t\t<ContentEditable\n\t\t\t\t\t\t\t\tclassName='taggable-text__input'\n\t\t\t\t\t\t\t\thtml={text.current}\n\t\t\t\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\t\t\t\tonKeyDown={(e) => {\n\t\t\t\t\t\t\t\t\tconsole.log(getCaretCharacterOffsetWithin(e.target))\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tonMouseUp={(e) => {\n\t\t\t\t\t\t\t\t\thandleSelection()\n\t\t\t\t\t\t\t\t\tconsole.log(getCaretCharacterOffsetWithin(e.target))\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tonKeyUp={(e) => {\n\t\t\t\t\t\t\t\t\thandleSelection();\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div ref={tagsRef} className=\"taggable-text__tags\" contentEditable={false} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t{whitelist.map(item => {\n\t\t\t\t\t\treturn (<div>\n\t\t\t\t\t\t\t{item.text}\n\t\t\t\t\t\t</div>)\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"dropdown\" ref={modalRef} style={modalStyles}>\n\t\t\t\t\t<div class=\"dropdown__inner\"><div class=\"dropdown__selection\">Selection: <strong>{selection}</strong></div></div>\n\t\t\t\t\t<button onClick={() => {tagSelection()}}>TAG!</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t)\n\t} else {\n\t\treturn null\n\t}\n}\n","import React, { useState, useEffect } from 'react'\nimport { getColor } from '../../helpers/common_constants.jsx'\nimport { Modal } from './IntentModal.jsx'\nimport Utterance from './utterance/Utterance.jsx'\n\nconst List = React.memo(function List(props) {\n\tconst [modal, setModal] = useState(false)\n\tconst [modalPosition, setModalPosition] = useState(null)\n\tconst [selection, setSelection] = useState(null)\n\tconst [update, setUpdate] = useState(false)\n\tconst [paramValues, setParamValues] = useState(null)\n\tconst [active, setActive] = useState(null)\n\n\tuseEffect(() => {\n\t\t// get every item type & slot value pair from utterances array\n\t\tlet arr = props.utterances\n\t\t\t.map((item) => item.model)\n\t\t\t.flat()\n\t\t\t.filter((item) => item.slot_value)\n\t\t\t.map((item) => ({ type: item.type, slot_value: item.slot_value }))\n\n\t\t// remove duplicate pairs\n\t\tlet uniq = arr.filter(\n\t\t\t(v, i, a) => a.findIndex((t) => t.slot_value === v.slot_value) === i\n\t\t)\n\t\tsetParamValues(uniq)\n\t}, [props.utterances])\n\n\tconst handleActive = (index) => {\n\t\tprops.setActive(index)\n\t}\n\n\tconst makeItems = (items) => {\n\t\treturn items.map((item, index) => {\n\t\t\treturn (\n\t\t\t\t<Utterance key={index} data={item} index={index} active={active} setActive={setActive}/>\n\t\t\t)\n\t\t})\n\t}\n\n\tconst removeFromUtterances = (index) => {\n\t\tlet arr = [...props.utterances]\n\t\tif (index !== -1) {\n\t\t\tarr.splice(index, 1)\n\t\t\tconsole.log('new arr after delete', arr)\n\t\t\tprops.setUtterances(arr)\n\t\t\tprops.setActive(null)\n\t\t}\n\t}\n\n\tconsole.log(selection)\n\n\tif (props.utterances) {\n\t\treturn (\n\t\t\t<React.Fragment>\n\t\t\t\t<ul>{makeItems(props.utterances)}</ul>\n\t\t\t\t{/* <Modal\n\t\t\t\t\tsetModal={setModal}\n\t\t\t\t\tmodal={modal}\n\t\t\t\t\tmodalPosition={modalPosition}\n\t\t\t\t\tselection={selection}\n\t\t\t\t\tsetSelection={setSelection}\n\t\t\t\t\tactive={props.active}\n\t\t\t\t\tutterances={props.utterances}\n\t\t\t\t\tsetUtterances={props.setUtterances}\n\t\t\t\t\tsetUpdate={setUpdate}\n\t\t\t\t\tupdate={update}\n\t\t\t\t\tstateChange={stateChange}\n\t\t\t\t\tsetStateChange={setStateChange}\n\t\t\t\t\tentities={props.entities.flat()}\n\t\t\t\t\tparamValues={paramValues}\n\t\t\t\t\tsetParamValues={setParamValues}\n\t\t\t\t/> */}\n\t\t\t</React.Fragment>\n\t\t)\n\t} else {\n\t\treturn null\n\t}\n})\n\nexport { List }\n","import React, { useState, useEffect } from 'react';\nimport { List as Utterances } from './IntentUtterances.jsx';\nimport _ from 'lodash';\nimport { useRef } from 'react';\nimport { validateInput } from '../../helpers/validations.jsx';\n\nfunction IntentDetails(props) {\n  const [intent, setIntent] = useState(props.intent);\n  const entities = props.entities;\n  const systemEntities = props.systemEntities;\n\n  const [name, setName] = useState('');\n  const [utterances, setUtterances] = useState([]);\n  const [active, setActive] = useState(null);\n  const [newExpression, setNewExpression] = useState(null);\n\n  const [valid, setValid] = useState(true);\n\n  const newExpressionInput = useRef(null);\n\n  const focusOnExpressionInput = () => {\n    newExpressionInput.current.focus();\n    newExpressionInput.current.value = '';\n    setActive(null);\n  };\n\n  // add new value to value array\n  function addNewValue() {\n    let arr = [...utterances];\n    let newUtterance = {\n      raw: newExpression ? newExpression : '',\n      model: [{ text: newExpression ? newExpression : '' }],\n    };\n    arr = [newUtterance, ...arr];\n    setUtterances(arr);\n    setActive(0);\n  }\n\n  const removeFromModel = (utteranceIndex, index) => {\n    let arr = [...utterances];\n    let model = arr[utteranceIndex].model;\n    model[index] = {\n      text: model[index].text,\n    };\n\n    setUtterances(arr);\n  };\n\n  // check if data is passed in props\n  useEffect(() => {\n    if (intent) {\n      setName(intent.name);\n      setUtterances(intent.utterances);\n    }\n  }, [intent]);\n\n  useEffect(() => {\n    if (name && utterances) {\n      props.onUpdate({\n        ...intent,\n        name: name,\n        utterances: utterances,\n      });\n    }\n  }, [name, utterances]);\n\n  if (intent) {\n    return (\n      <div className=\"convo-details\">\n        <section className=\"layout--editor-content\">\n          <div>\n            {/* Entity name value */}\n            <div className=\"margin--30--large\">\n              <h3 className=\"margin--10--large\">Intent name</h3>\n              <form\n                onSubmit={e => {\n                  e.preventDefault();\n                }}\n              >\n                <input\n                  type=\"text\"\n                  defaultValue={name ? name : ''}\n                  placeholder=\"Intent name\"\n                  className=\"editor-input input--item-name\"\n                  onChange={e => {\n                    let message =\n                      'Intent names shall begin with alphabetic characters from a to Z. The intent name may contain 1 underscore per word. Intent names shall not contain any numbers at all.';\n                    validateInput(\n                      e.target,\n                      e.target.value,\n                      '^[A-Za-z](_?[A-Za-z])*_?$',\n                      message\n                    );\n                    setName(e.target.value);\n                  }}\n                  required\n                />\n              </form>\n            </div>\n            {/* Entity words */}\n            <div className=\"margin--50--large\">\n              <h3 className=\"margin--10--large\">Utterances</h3>\n              <div className=\"margin--24--large\">\n                <form\n                  onSubmit={e => {\n                    e.preventDefault();\n                    if (newExpression) {\n                      addNewValue();\n                      setNewExpression(null);\n                      newExpressionInput.current.value = '';\n                    }\n                  }}\n                >\n                  <input\n                    type=\"text\"\n                    className=\"editor-input input--add-field\"\n                    placeholder=\"Enter reference value\"\n                    onChange={e => setNewExpression(e.target.value)}\n                    ref={newExpressionInput}\n                    onFocus={() => {\n                      setActive(null);\n                    }}\n                  />\n                </form>\n                <Utterances\n                  addNewValue={addNewValue}\n                  active={active}\n                  setActive={setActive}\n                  utterances={utterances}\n                  setUtterances={setUtterances}\n                  removeFromModel={removeFromModel}\n                  entities={[entities, ...systemEntities]}\n                  focusOnExpressionInput={focusOnExpressionInput}\n                />\n              </div>\n            </div>\n          </div>\n        </section>\n      </div>\n    );\n  } else {\n    return null;\n  }\n}\n\nexport default IntentDetails;\n","import React from 'react'\nimport EntityDetails from './components/EntityComponent/EntityDetails'\nimport IntentDetails from './components/IntentComponent/IntentDetails'\nimport './styles.scss'\n\nexport const IntentEditor = (props) => {\n  return <IntentDetails intent={props.intent} entities={props.entities} systemEntities={props.systemEntities} onUpdate={props.onUpdate} />\n}\n\nexport const EntityEditor = (props) => {\n  return <EntityDetails entity={props.entity} onUpdate={props.onUpdate} />\n}"],"names":["IconTrash","EntityValue","props","value","setValue","useState","item","synonyms","setSynonyms","newSynonym","setNewSynonym","remove","setRemove","synonymInput","useRef","useEffect","handleUpdate","values","index","handleNewSynonym","target","current","length","removeSynonym","arr","indexOf","splice","makeSynonyms","items","active","map","i","handleRemove","e","stopPropagation","setTimeout","removeValue","activeValue","setActiveValue","preventDefault","marginLeft","EntityValues","setValues","makeItems","validateInput","elem","term","regex","message","reg","RegExp","test","setCustomValidity","reportValidity","EntityDetails","entity","setEntity","name","setName","newValue","setNewValue","valid","setValid","valueInput","onUpdate","addNewValue","val","validate","stringToColor","getHashCode","intToHSL","String","prototype","hash","charCodeAt","Number","shortened","getCaretCharacterOffsetWithin","element","caretOffset","doc","ownerDocument","document","win","defaultView","parentWindow","sel","getSelection","rangeCount","range","getRangeAt","preCaretRange","cloneRange","selectNodeContents","setEnd","endContainer","endOffset","toString","selection","type","textRange","createRange","preCaretTextRange","body","createTextRange","moveToElementText","setEndPoint","text","Utterance","raw","setRaw","state","setState","modalState","setModalState","position","inputText","setInputText","model","setModel","data","setSelection","whitelist","setWhitelist","filter","slot_value","input","modalRef","tagsRef","targetText","handleChange","evt","innerHTML","parseText","string","str","replace","trim","join","matched","tagSelection","list","includes","handleSelection","window","modify","isCollapsed","setStart","anchorNode","anchorOffset","focusNode","focusOffset","backwards","collapsed","detach","endNode","collapse","direction","extend","expand","moveEnd","select","s","oRange","oRect","getBoundingClientRect","x","modalStyles","top","transition","visibility","opacity","left","setActive","console","log","List","React","memo","modal","setModal","modalPosition","setModalPosition","update","setUpdate","paramValues","setParamValues","utterances","flat","uniq","v","a","findIndex","t","IntentDetails","intent","setIntent","entities","systemEntities","setUtterances","newExpression","setNewExpression","newExpressionInput","focusOnExpressionInput","focus","newUtterance","removeFromModel","utteranceIndex","Utterances","IntentEditor","EntityEditor"],"mappings":"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"}